const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/OrganizationForm-0K6MRoIK.js","assets/index-B_3v-ox1.js","assets/index-ByN57GGS.css","assets/index.esm-_f0UyMzC.js","assets/Grid-me3b-Vt9.js","assets/TextField-wiIP_mJQ.js","assets/useFormControl-DthVT5lQ.js","assets/InputBase-3u8fo18V.js","assets/DatePicker-BYuvgZha.js","assets/InputAdornment-Bz6YTIsx.js","assets/DialogContent-BTFYcNfm.js","assets/GenericModal-DynwTqO5.js"])))=>i.map(i=>d[i]);
import{p as F,q as I,A as m,t as T,v as l,x as k,y as L,z as G,E as V,F as q,G as H,H as J,I as K,J as Q,r,h as x,j as i,B as W,K as S}from"./index-B_3v-ox1.js";import{h as U}from"./auth-CvwlPVjT.js";import{u as X,R as Y}from"./usePaginationParams-DZP_NYrL.js";import"./Save-DPkrjgoa.js";import"./reselect-COqK-9k0.js";import"./InputBase-3u8fo18V.js";import"./useFormControl-DthVT5lQ.js";import"./TextField-wiIP_mJQ.js";import"./InputAdornment-Bz6YTIsx.js";import"./Checkbox-VvSH1ZMt.js";import"./SwitchBase-BcTtwyWN.js";import"./FormControlLabel-_HHpWdYW.js";import"./KeyboardArrowRight-DZvdNCzv.js";import"./TableCell-dKph4lyS.js";import"./CircularProgress-VYlyA5-Z.js";const Z=a=>async o=>{var e,d;try{const s=F(a);o(I());const c=await m.getOrganizations(s);console.log(c),o(T(c.data.data))}catch(s){l.error(((d=(e=s.response)==null?void 0:e.data)==null?void 0:d.data)||"Failed to fetch organizations",{autoClose:3e3})}},$=a=>async o=>{try{o(J());const e=await m.getOrganizationById(a);o(K(e.data.data))}catch(e){l.error(e.response.data.data||"Failed to fetch organization",{autoClose:3e3})}},ee=a=>async o=>{try{o(q());const e=await m.createOrganization(a);return o(H(e.data.data)),e.data}catch(e){l.error(e.response.data.data||"Failed to fetch organization",{autoClose:3e3})}},ae=a=>async o=>{try{o(G());const e=await m.updateOrganization(a,a.id);return o(V(e.data.data)),e.data}catch(e){l.error(e.response.data.data||"Failed to fetch organization",{autoClose:3e3})}},te=a=>async o=>{var e,d;try{o(k());const s=await m.deleteOrganization(a);o(L(a)),l.info("Organization deleted successfully",{autoClose:3e3})}catch(s){l.error(((d=(e=s==null?void 0:s.response)==null?void 0:e.data)==null?void 0:d.data)||"Failed to fetch organization",{autoClose:3e3})}},h={fetchOrganizations:Z,fetchOrganizationById:$,createOrganization:ee,updateOrganization:ae,deleteOrganization:te},oe=r.lazy(()=>S(()=>import("./OrganizationForm-0K6MRoIK.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))),se=r.lazy(()=>S(()=>import("./GenericModal-DynwTqO5.js"),__vite__mapDeps([11,1,2,10])));function Ce(){const a=Q(),o=r.useMemo(()=>[{field:"name",headerName:"Name",flex:1,editable:!0,headerClassName:"theme--header"},{field:"category",headerName:"Category",flex:1,editable:!0,headerClassName:"theme--header"},{field:"number",headerName:"Number",flex:1,editable:!0,headerClassName:"theme--header"},{field:"contactEmail",headerName:"Contact Email",flex:1,editable:!0,headerClassName:"theme--header"},{field:"contactPhone",headerName:"Contact Phone",flex:1,editable:!0,headerClassName:"theme--header"},{field:"establishedDate",headerName:"Established Date",flex:1,editable:!0,headerClassName:"theme--header"},{field:"description",headerName:"Description",flex:1,editable:!0,headerClassName:"theme--header"}],[]),[e,d]=r.useState({}),[s,c]=r.useState(!1),[b,z]=r.useState(void 0),[u,O]=r.useState(null),{data:n,loading:N}=x(t=>t.organization),g=x(t=>t.auth.user),w=r.useMemo(()=>!g||!(n!=null&&n.organizations)?[]:n.organizations.filter(t=>U(g,"organizations","view",t)),[g,n]),_=r.useCallback(t=>{a(h.fetchOrganizations(t))},[a]),{params:p,setParams:v}=X({page:1,limit:10,sortBy:void 0,sortOrder:void 0,searchTerm:void 0,filters:{}},_),E=t=>{v(t)},P=()=>{O(null),z("Add Organization"),y()},D=t=>{const C=n==null?void 0:n.organizations.find(B=>B._id===t);console.log("selectedOrganization",C),O(C),z("Edit Organization"),y()},j=async t=>{a(h.deleteOrganization(t))},R=async t=>{a(u?h.updateOrganization({id:u._id,...t}):h.createOrganization(t)),f()},A=()=>{a(h.fetchOrganizations(p))},y=()=>c(!0),f=()=>c(!1),M=(n==null?void 0:n.totalOrganizations)||0;return i.jsxs(W,{sx:{width:"100%",height:"100%",minWidth:0,overflow:"hidden"},children:[i.jsx(Y,{columns:o,onAdd:P,onDelete:j,onEdit:D,rows:w??[],rowModesModel:e,setRowModesModel:d,loading:N,reloadData:A,totalRows:M,paginationModel:{page:p.page-1,pageSize:p.limit},onParamsChange:t=>E(t)}),s&&i.jsx(r.Suspense,{fallback:i.jsx("div",{children:"Loading modal..."}),children:i.jsx(se,{open:s,onClose:f,title:b,children:i.jsx(r.Suspense,{fallback:i.jsx("div",{children:"Loading form..."}),children:i.jsx(oe,{initialValues:u,onSubmit:R,onClose:f})})})})]})}export{Ce as default};
//# sourceMappingURL=Organizations-xBtDv9Bl.js.map
