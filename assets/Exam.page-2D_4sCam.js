const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ExamForm-B32BazKM.js","assets/index-R703-jZn.js","assets/index-ByN57GGS.css","assets/index.esm-Brhin-EH.js","assets/Grid-DNVof5P2.js","assets/TextField-DnDWyxTy.js","assets/useFormControl-CXpyBcMX.js","assets/InputBase-lCwOyFCU.js","assets/DatePicker-BlfIytG2.js","assets/InputAdornment-Dv0N28eP.js","assets/DialogContent-Szz1wD6j.js","assets/GenericModal-CI9EKe7h.js"])))=>i.map(i=>d[i]);
import{p as F,aV as I,aW as c,aX as O,v as m,aY as L,aZ as V,a_ as z,a$ as G,b0 as W,b1 as q,b2 as J,b3 as K,J as Q,r as d,h as C,j as l,B as X,K as b}from"./index-R703-jZn.js";import{h as Y}from"./auth-CvwlPVjT.js";import{u as Z,R as $}from"./usePaginationParams-RhE3YGkD.js";import"./Save-DQXd9c0C.js";import"./reselect-B5WBFqaJ.js";import"./InputBase-lCwOyFCU.js";import"./useFormControl-CXpyBcMX.js";import"./TextField-DnDWyxTy.js";import"./InputAdornment-Dv0N28eP.js";import"./Checkbox-CZRmEr2R.js";import"./SwitchBase-D4fUKCtc.js";import"./FormControlLabel-D7wS11kJ.js";import"./KeyboardArrowRight-PT1jTHRk.js";import"./TableCell-DAW-rVix.js";import"./CircularProgress-DTH0MZKS.js";const H=a=>async s=>{var e,n;try{const r=F(a);s(I());const h=await c.getExams(r);s(O(h.data.data))}catch(r){m.error(((n=(e=r.response)==null?void 0:e.data)==null?void 0:n.data)||"Failed to fetch exams",{autoClose:3e3})}},U=a=>async s=>{try{s(J());const e=await c.getExamById(a);s(K(e.data.data))}catch(e){m.error(e.response.data.data||"Failed to fetch exam",{autoClose:3e3})}},ee=a=>async s=>{try{s(W());const e=await c.createExam(a);return s(q(e.data.data)),e.data}catch(e){m.error(e.response.data.data||"Failed to create exam",{autoClose:3e3})}},ae=a=>async s=>{try{s(z());const e=await c.updateExam(a,a._id);return s(G(e.data.data)),e.data}catch(e){m.error(e.response.data.data||"Failed to update exam",{autoClose:3e3})}},te=a=>async s=>{var e,n;try{s(L());const r=await c.deleteExam(a);s(V(a)),m.info("Exam deleted successfully",{autoClose:3e3})}catch(r){m.error(((n=(e=r==null?void 0:r.response)==null?void 0:e.data)==null?void 0:n.data)||"Failed to delete exam",{autoClose:3e3})}},i={fetchExams:H,fetchExamById:U,createExam:ee,updateExam:ae,deleteExam:te},se=d.lazy(()=>b(()=>import("./ExamForm-B32BazKM.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))),re=d.lazy(()=>b(()=>import("./GenericModal-CI9EKe7h.js"),__vite__mapDeps([11,1,2,10])));function Ce(){const a=Q(),s=d.useMemo(()=>[{field:"name",headerName:"Exam Name",flex:1,editable:!0,headerClassName:"theme--header"},{field:"examType",headerName:"Exam Type",flex:1,editable:!0,headerClassName:"theme--header"},{field:"duration",headerName:"Duration (min)",flex:1,editable:!0,headerClassName:"theme--header"},{field:"totalMarks",headerName:"Total Marks",flex:1,editable:!0,headerClassName:"theme--header"},{field:"startDate",headerName:"Start Date",flex:1,editable:!0,headerClassName:"theme--header"},{field:"endDate",headerName:"End Date",flex:1,editable:!0,headerClassName:"theme--header"},{field:"schedule",headerName:"Schedule",flex:1,editable:!0,headerClassName:"theme--header"},{field:"description",headerName:"Description",flex:1,editable:!0,headerClassName:"theme--header"}],[]),[e,n]=d.useState({}),[r,h]=d.useState(!1),[N,f]=d.useState(void 0),[u,y]=d.useState(null),{data:o,loading:_}=C(t=>t.exam),x=C(t=>t.auth.user),g=d.useMemo(()=>!x||!(o!=null&&o.exams)?[]:o.exams.filter(t=>Y(x,"exams","view",t)),[x,o]),w=d.useCallback(t=>{a(i.fetchExams(t))},[a]),{params:p,setParams:D}=Z({page:1,limit:10,sortBy:void 0,sortOrder:void 0,searchTerm:void 0,filters:{}},w),v=t=>{D(t)},P=()=>{y(null),f("Add Exam"),S()},M=t=>{const A=o==null?void 0:o.exams.find(k=>k._id===t);y(A),f("Edit Exam"),S()},j=async t=>{a(i.deleteExam(t))},R=async t=>{a(u?i.updateExam({id:u._id,...t}):i.createExam(t)),E()},B=()=>{a(i.fetchExams(p))},S=()=>h(!0),E=()=>h(!1),T=(o==null?void 0:o.totalExams)||0;return l.jsxs(X,{sx:{width:"100%",height:"100%",minWidth:0,overflow:"hidden"},children:[l.jsx($,{columns:s,onAdd:P,onDelete:j,onEdit:M,rows:g??[],rowModesModel:e,setRowModesModel:n,loading:_,reloadData:B,totalRows:T,paginationModel:{page:p.page-1,pageSize:p.limit},onParamsChange:t=>v(t)}),r&&l.jsx(d.Suspense,{fallback:l.jsx("div",{children:"Loading modal..."}),children:l.jsx(re,{open:r,onClose:E,title:N,children:l.jsx(d.Suspense,{fallback:l.jsx("div",{children:"Loading form..."}),children:l.jsx(se,{initialValues:u,onSubmit:R,onClose:E})})})})]})}export{Ce as default};
//# sourceMappingURL=Exam.page-2D_4sCam.js.map
