import{p as L,q as P,r as k,s as G,j as e,t as N,v as _,w as C,x as Z,y as D,z as F,C as H,D as X,E as K,o as W,d as O,M as b,B as I,T as $,a as E,n as J,F as A}from"./index-MrjMEUwI.js";import{u as Q,C as o,R as V,G as ee}from"./ReusableDataGrid-CY8WDnLJ.js";import{G as n}from"./Grid-ACPbpOGS.js";import{T as f,F as T,I as M,S as U,a as B}from"./TextField-CaDdvICp.js";import{D as re}from"./DatePicker-gAleKSi0.js";import{S as ae,F as se}from"./FormControlLabel-B734Chuj.js";import"./useId-KuTEVYsR.js";import"./Tooltip-D2_QTKR8.js";import"./Checkbox-BleoHsex.js";import"./KeyboardArrowRight-CUDh3jy8.js";import"./CircularProgress-CwZ4sAXt.js";import"./Skeleton-C-75NkSS.js";function te(r){return P("MuiSwitch",r)}const h=L("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]),le=r=>{const{classes:l,edge:c,size:v,color:d,checked:j,disabled:i}=r,y={root:["root",c&&`edge${C(c)}`,`size${C(v)}`],switchBase:["switchBase",`color${C(d)}`,j&&"checked",i&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},t=Z(y,te,l);return{...l,...t}},ie=N("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(r,l)=>{const{ownerState:c}=r;return[l.root,c.edge&&l[`edge${C(c.edge)}`],l[`size${C(c.size)}`]]}})({display:"inline-flex",width:34+12*2,height:14+12*2,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"},variants:[{props:{edge:"start"},style:{marginLeft:-8}},{props:{edge:"end"},style:{marginRight:-8}},{props:{size:"small"},style:{width:40,height:24,padding:7,[`& .${h.thumb}`]:{width:16,height:16},[`& .${h.switchBase}`]:{padding:4,[`&.${h.checked}`]:{transform:"translateX(16px)"}}}}]}),ne=N(ae,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(r,l)=>{const{ownerState:c}=r;return[l.switchBase,{[`& .${h.input}`]:l.input},c.color!=="default"&&l[`color${C(c.color)}`]]}})(D(({theme:r})=>({position:"absolute",top:0,left:0,zIndex:1,color:r.vars?r.vars.palette.Switch.defaultColor:`${r.palette.mode==="light"?r.palette.common.white:r.palette.grey[300]}`,transition:r.transitions.create(["left","transform"],{duration:r.transitions.duration.shortest}),[`&.${h.checked}`]:{transform:"translateX(20px)"},[`&.${h.disabled}`]:{color:r.vars?r.vars.palette.Switch.defaultDisabledColor:`${r.palette.mode==="light"?r.palette.grey[100]:r.palette.grey[600]}`},[`&.${h.checked} + .${h.track}`]:{opacity:.5},[`&.${h.disabled} + .${h.track}`]:{opacity:r.vars?r.vars.opacity.switchTrackDisabled:`${r.palette.mode==="light"?.12:.2}`},[`& .${h.input}`]:{left:"-100%",width:"300%"}})),D(({theme:r})=>({"&:hover":{backgroundColor:r.vars?`rgba(${r.vars.palette.action.activeChannel} / ${r.vars.palette.action.hoverOpacity})`:F(r.palette.action.active,r.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},variants:[...Object.entries(r.palette).filter(H(["light"])).map(([l])=>({props:{color:l},style:{[`&.${h.checked}`]:{color:(r.vars||r).palette[l].main,"&:hover":{backgroundColor:r.vars?`rgba(${r.vars.palette[l].mainChannel} / ${r.vars.palette.action.hoverOpacity})`:F(r.palette[l].main,r.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${h.disabled}`]:{color:r.vars?r.vars.palette.Switch[`${l}DisabledColor`]:`${r.palette.mode==="light"?X(r.palette[l].main,.62):K(r.palette[l].main,.55)}`}},[`&.${h.checked} + .${h.track}`]:{backgroundColor:(r.vars||r).palette[l].main}}}))]}))),oe=N("span",{name:"MuiSwitch",slot:"Track",overridesResolver:(r,l)=>l.track})(D(({theme:r})=>({height:"100%",width:"100%",borderRadius:14/2,zIndex:-1,transition:r.transitions.create(["opacity","background-color"],{duration:r.transitions.duration.shortest}),backgroundColor:r.vars?r.vars.palette.common.onBackground:`${r.palette.mode==="light"?r.palette.common.black:r.palette.common.white}`,opacity:r.vars?r.vars.opacity.switchTrack:`${r.palette.mode==="light"?.38:.3}`}))),de=N("span",{name:"MuiSwitch",slot:"Thumb",overridesResolver:(r,l)=>l.thumb})(D(({theme:r})=>({boxShadow:(r.vars||r).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"}))),ce=k.forwardRef(function(l,c){const v=G({props:l,name:"MuiSwitch"}),{className:d,color:j="primary",edge:i=!1,size:y="medium",sx:t,...z}=v,w={...v,color:j,edge:i,size:y},m=le(w),a=e.jsx(de,{className:m.thumb,ownerState:w});return e.jsxs(ie,{className:_(m.root,d),sx:t,ownerState:w,children:[e.jsx(ne,{type:"checkbox",icon:a,checkedIcon:a,ref:c,ownerState:w,...z,classes:{...m,root:m.switchBase}}),e.jsx(oe,{className:m.track,ownerState:w})]})}),me=({initialValues:r,onSubmit:l,onClose:c})=>{var m;const{data:v}=W(a=>a.organization),d=(m=v==null?void 0:v.organizations)==null?void 0:m.map(a=>({id:a._id,name:a.name})),j={_id:"",organizations:d||[],organizationId:d?d[0].id:"",username:"",email:"",fullname:"",avatar:"",coverImage:"",age:"",role:"STUDENT",gender:"male",phone:"",address:{street:"",city:"",state:"",zip:"",country:""},status:"active",dateOfBirth:null,biography:"",permissions:[],socialLinks:{facebook:"",twitter:"",linkedin:"",instagram:""},preferences:{notifications:!0,language:"en",theme:"light",timezone:"Asia/Kolkata",currency:"INR",dateFormat:"DD/MM/YYYY"},createdAt:null,updatedAt:null},{control:i,handleSubmit:y,formState:{errors:t},reset:z}=Q({defaultValues:j});k.useEffect(()=>{r&&z({...r,dateOfBirth:r.dateOfBirth?O(r.dateOfBirth):null,createdAt:r.createdAt?O(r.createdAt):null,updatedAt:r.updatedAt?O(r.updatedAt):null})},[r,z]);const w=a=>{const s={...a,dateOfBirth:a.dateOfBirth?a.dateOfBirth.format("YYYY-MM-DD"):null,createdAt:a.createdAt?a.createdAt.format("YYYY-MM-DD"):null,updatedAt:a.updatedAt?a.updatedAt.format("YYYY-MM-DD"):null,organizations:a.organizations,organizationId:a.organizations?a.organizations[0].id:""};l(s)};return e.jsx("form",{onSubmit:y(w),children:e.jsxs(n,{container:!0,spacing:2,children:[e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(o,{name:"username",control:i,rules:{required:"Username is required"},render:({field:a})=>{var s;return e.jsx(f,{...a,label:"Username",size:"small",fullWidth:!0,margin:"normal",error:!!t.username,helperText:(s=t.username)==null?void 0:s.message})}})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(o,{name:"fullname",control:i,rules:{required:"Full name is required"},render:({field:a})=>{var s;return e.jsx(f,{...a,label:"Full Name",size:"small",fullWidth:!0,margin:"normal",error:!!t.fullname,helperText:(s=t.fullname)==null?void 0:s.message})}})}),e.jsx(n,{item:!0,xs:12,children:e.jsx(o,{name:"organizations",control:i,rules:{required:"At least one organization is required"},render:({field:a})=>{var s;return e.jsxs(T,{fullWidth:!0,margin:"normal",error:!!t.organizations,children:[e.jsx(M,{children:"Organizations"}),e.jsx(U,{...a,multiple:!0,label:"Organizations",size:"small",renderValue:u=>e.jsx(I,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:u.map(p=>{var x;return e.jsx($,{component:"span",variant:"body2",children:(x=d==null?void 0:d.find(g=>g.id===p))==null?void 0:x.name},p)})}),children:d==null?void 0:d.map(u=>e.jsx(b,{value:u.id,children:u.name},u.id))}),e.jsx(B,{children:(s=t.organizations)==null?void 0:s.message})]})}})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(o,{name:"email",size:"small",control:i,rules:{required:"Email is required",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Invalid email address"}},render:({field:a})=>{var s;return e.jsx(f,{...a,label:"Email",size:"small",fullWidth:!0,margin:"normal",error:!!t.email,helperText:(s=t.email)==null?void 0:s.message})}})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(o,{name:"age",control:i,rules:{required:"Age is required",pattern:{value:/^[0-9]+$/,message:"Age must be a number"}},render:({field:a})=>{var s;return e.jsx(f,{...a,label:"Age",size:"small",fullWidth:!0,margin:"normal",error:!!t.age,helperText:(s=t.age)==null?void 0:s.message})}})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(o,{name:"role",control:i,rules:{required:"Role is required"},render:({field:a})=>{var s;return e.jsxs(T,{fullWidth:!0,margin:"normal",error:!!t.role,size:"small",children:[e.jsx(M,{children:"Role"}),e.jsxs(U,{...a,label:"Role",children:[e.jsx(b,{value:"ADMIN",children:"Admin"}),e.jsx(b,{value:"TEACHER",children:"Teacher"}),e.jsx(b,{value:"STUDENT",children:"Student"}),e.jsx(b,{value:"PARENT",children:"Parent"})]}),e.jsx(B,{children:(s=t.role)==null?void 0:s.message})]})}})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(o,{name:"gender",control:i,rules:{required:"Gender is required"},render:({field:a})=>{var s;return e.jsxs(T,{fullWidth:!0,margin:"normal",error:!!t.gender,size:"small",children:[e.jsx(M,{children:"Gender"}),e.jsxs(U,{...a,label:"Gender",children:[e.jsx(b,{value:"male",children:"Male"}),e.jsx(b,{value:"female",children:"Female"}),e.jsx(b,{value:"other",children:"Other"})]}),e.jsx(B,{children:(s=t.gender)==null?void 0:s.message})]})}})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(o,{name:"phone",control:i,rules:{pattern:{value:/^[0-9]{10}$/,message:"Invalid phone number"}},render:({field:a})=>{var s;return e.jsx(f,{...a,label:"Phone",size:"small",fullWidth:!0,margin:"normal",error:!!t.phone,helperText:(s=t.phone)==null?void 0:s.message})}})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(o,{name:"avatar",control:i,render:({field:a})=>{var s;return e.jsx(f,{...a,label:"Avatar URL",size:"small",fullWidth:!0,margin:"normal",error:!!t.avatar,helperText:(s=t.avatar)==null?void 0:s.message})}})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(o,{name:"coverImage",control:i,render:({field:a})=>{var s;return e.jsx(f,{...a,label:"Cover Image URL",size:"small",fullWidth:!0,margin:"normal",error:!!t.coverImage,helperText:(s=t.coverImage)==null?void 0:s.message})}})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(o,{name:"dateOfBirth",control:i,render:({field:a})=>{var s;return e.jsx(re,{label:"Date of Birth",value:a.value,onChange:u=>a.onChange(u),slotProps:{textField:{size:"small",fullWidth:!0,error:!!t.dateOfBirth,helperText:(s=t.dateOfBirth)==null?void 0:s.message}}})}})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(o,{name:"status",control:i,render:({field:a})=>{var s;return e.jsxs(T,{fullWidth:!0,margin:"normal",error:!!t.status,size:"small",children:[e.jsx(M,{children:"Status"}),e.jsxs(U,{...a,label:"Status",children:[e.jsx(b,{value:"active",children:"Active"}),e.jsx(b,{value:"inactive",children:"Inactive"})]}),e.jsx(B,{children:(s=t.status)==null?void 0:s.message})]})}})}),e.jsx(n,{item:!0,xs:12,children:e.jsx(o,{name:"biography",control:i,render:({field:a})=>{var s;return e.jsx(f,{...a,label:"Biography",fullWidth:!0,multiline:!0,rows:4,margin:"normal",error:!!t.biography,helperText:(s=t.biography)==null?void 0:s.message})}})}),e.jsx(n,{item:!0,xs:12,children:e.jsx($,{variant:"h6",children:"Address"})}),["street","city","state","zip","country"].map(a=>e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(o,{name:`address.${a}`,control:i,render:({field:{onChange:s,value:u}})=>{var p,x,g;return e.jsx(f,{label:a.charAt(0).toUpperCase()+a.slice(1),fullWidth:!0,margin:"normal",size:"small",value:u,onChange:s,error:!!((p=t.address)!=null&&p[a]),helperText:(g=(x=t.address)==null?void 0:x[a])==null?void 0:g.message})}})},a)),e.jsx(n,{item:!0,xs:12,children:e.jsx($,{variant:"h6",children:"Social Links"})}),["facebook","twitter","linkedin","instagram"].map(a=>e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(o,{name:`socialLinks.${a}`,control:i,render:({field:{onChange:s,value:u}})=>{var p,x,g;return e.jsx(f,{label:a.charAt(0).toUpperCase()+a.slice(1),fullWidth:!0,margin:"normal",size:"small",value:u,onChange:s,error:!!((p=t.socialLinks)!=null&&p[a]),helperText:(g=(x=t.socialLinks)==null?void 0:x[a])==null?void 0:g.message})}})},a)),e.jsx(n,{item:!0,xs:12,children:e.jsx($,{variant:"h6",children:"Preferences"})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(o,{name:"preferences.notifications",control:i,render:({field:{onChange:a,value:s}})=>e.jsx(se,{control:e.jsx(ce,{checked:s,onChange:a,color:"primary"}),label:"Notifications"})})}),["language","theme","timezone","currency","dateFormat"].map(a=>e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(o,{name:`preferences.${a}`,control:i,render:({field:{onChange:s,value:u}})=>{var p,x,g;return e.jsx(f,{label:a.charAt(0).toUpperCase()+a.slice(1),fullWidth:!0,margin:"normal",size:"small",value:u,onChange:s,error:!!((p=t.preferences)!=null&&p[a]),helperText:(g=(x=t.preferences)==null?void 0:x[a])==null?void 0:g.message})}})},a)),e.jsx(n,{item:!0,xs:12,children:e.jsxs(I,{sx:{display:"flex",justifyContent:"flex-end",gap:2,mt:2},children:[e.jsx(E,{variant:"outlined",color:"primary",onClick:()=>{z(j),c()},children:"Cancel"}),e.jsx(E,{type:"submit",variant:"contained",color:"primary",children:"Save"})]})})]})})};function ye(){const r=J(),[l,c]=k.useState({}),[v,d]=k.useState(""),[j,i]=k.useState(null),[y,t]=k.useState(!1),z=k.useMemo(()=>[{field:"username",headerName:"Username",flex:1,editable:!0,headerClassName:"theme--header"},{field:"email",headerName:"Email",flex:1,editable:!0,headerClassName:"theme--header"},{field:"fullname",headerName:"Full Name",flex:1,editable:!0,headerClassName:"theme--header"},{field:"role",headerName:"Role",flex:1,editable:!0,headerClassName:"theme--header"},{field:"gender",headerName:"Gender",flex:1,editable:!0,headerClassName:"theme--header"},{field:"status",headerName:"Status",flex:1,editable:!0,headerClassName:"theme--header"}],[]),{loading:w,data:m}=W(S=>S.user);k.useEffect(()=>{r(A.fetchUsers())},[r]);const a=()=>{i(null),d("Add User"),g()},s=S=>{const Y=m==null?void 0:m.users.find(q=>q._id===S);i(Y||null),d("Edit User"),g()},u=S=>{r(A.deleteUser(S))},p=async S=>{j!=null&&j._id?r(A.updateUser({...S,_id:j._id})):r(A.createUser(S)),R()},x=()=>{r(A.fetchUsers())},g=()=>t(!0),R=()=>t(!1);return e.jsxs(I,{sx:{width:"100%",height:"100%"},children:[e.jsx(V,{columns:z,onAdd:a,onEdit:s,onDelete:u,rows:(m==null?void 0:m.users)||[],rowModesModel:l,setRowModesModel:c,loading:w,reloadData:x}),e.jsx(ee,{open:y,onClose:R,title:v,children:e.jsx(me,{initialValues:j,onSubmit:p,onClose:R})})]})}export{ye as default};
