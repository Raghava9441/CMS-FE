import{G as Y,H as C,I as G,J as q,c as b,K as P,L as Q,N as U,O as Z,P as $,Q as L,R as k,S as J,o as N,r as T,d as E,j as e,M as v,T as z,B as D,a as F,n as K}from"./index-DTnRkjLX.js";import{u as X,C as u,R as V,G as ee}from"./ReusableDataGrid-CkhIHv6t.js";import{G as c}from"./Grid-BLyvLPaw.js";import{F as M,I as W,S as _,a as H,T as j}from"./TextField-BKJnCYYx.js";import"./useId-Czgy0NDF.js";import"./Tooltip-1GxQcwBz.js";import"./Checkbox-BJW8qXBm.js";import"./FormControlLabel-CfzBg247.js";import"./KeyboardArrowRight-DtFBL45C.js";import"./CircularProgress-CAni-gj4.js";import"./Skeleton-CKGO1IT6.js";const re=()=>async t=>{var s,n;try{t(Y());const m=await C.getTeachers();t(G(m.data.data))}catch(m){t(q()),b.error(((n=(s=m.response)==null?void 0:s.data)==null?void 0:n.data)||"Failed to fetch organizations",{autoClose:3e3})}},ae=t=>async s=>{try{s(k());const n=await C.getTeacherById(t);s(J(n.data.data))}catch(n){s(q()),b.error(n.response.data.data||"Failed to fetch organization",{autoClose:3e3})}},te=t=>async s=>{try{s($());const n=await C.createTeacher(t);return s(L(n.data.data)),n.data}catch(n){s(q()),b.error(n.response.data.data||"Failed to fetch organization",{autoClose:3e3})}},se=t=>async s=>{try{if(s(U()),t._id){const n=await C.updateTeacher(t,t._id);return s(Z(n.data.data)),n.data}else throw new Error("Teacher ID is required for update")}catch(n){s(q()),n instanceof Error&&b.error(n.message||"Failed to fetch organization",{autoClose:3e3})}},ne=t=>async s=>{try{s(P());const n=await C.deleteTeacher(t);s(Q(t)),b.info(n.message||"Organization deleted successfully",{autoClose:3e3})}catch(n){s(q()),console.log(n),b.error(n.response.data.data||"Failed to fetch organization",{autoClose:3e3})}},A={fetchTeachers:re,fetchTeacherById:ae,createTeachers:te,updateTeachers:se,deleteTeachers:ne},ie=({initialValues:t,onSubmit:s,onClose:n})=>{var I;const{data:m}=N(r=>r.user),{data:S}=N(r=>r.organization),x=(I=m==null?void 0:m.users)==null?void 0:I.filter(r=>r.role==="TEACHER"),h=S==null?void 0:S.organizations,g={_id:"",userId:"",name:"",phone:"",email:"",organizationId:"",organizations:[],departments:[],subjects:[],qualifications:"",experience:0,officeHours:"",coursesTaught:[],performanceReviews:[],specialResponsibilities:"",createdAt:null,updatedAt:null},{control:l,handleSubmit:R,formState:{errors:i},reset:y}=X({defaultValues:g});T.useEffect(()=>{t&&y({...t,createdAt:t.createdAt?E(t.createdAt):null,updatedAt:t.updatedAt?E(t.updatedAt):null})},[t,y]);const w=r=>{const a={...r,createdAt:r.createdAt?r.createdAt.format("YYYY-MM-DD"):null,updatedAt:r.updatedAt?r.updatedAt.format("YYYY-MM-DD"):null};s(a)};return e.jsx("form",{onSubmit:R(w),children:e.jsxs(c,{container:!0,spacing:2,children:[e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(u,{name:"userId",control:l,rules:{required:"User ID is required"},render:({field:r})=>{var a;return e.jsxs(M,{fullWidth:!0,margin:"normal",error:!!i.userId,children:[e.jsx(W,{children:"User ID"}),e.jsx(_,{...r,label:"User ID",renderValue:o=>{var f;return e.jsx(z,{variant:"body2",children:(f=x==null?void 0:x.find(p=>p._id===o))==null?void 0:f.username})},children:x==null?void 0:x.map(o=>e.jsx(v,{value:o._id,children:o.username},o._id))}),e.jsx(H,{children:(a=i.userId)==null?void 0:a.message})]})}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(u,{name:"name",control:l,rules:{required:"Name is required"},render:({field:r})=>{var a;return e.jsx(j,{...r,label:"Name",fullWidth:!0,margin:"normal",error:!!i.name,helperText:(a=i.name)==null?void 0:a.message})}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(u,{name:"phone",control:l,rules:{required:"Phone is required",pattern:{value:/^[0-9]{10}$/,message:"Invalid phone number"}},render:({field:r})=>{var a;return e.jsx(j,{...r,label:"Phone Number",fullWidth:!0,margin:"normal",error:!!i.phone,helperText:(a=i.phone)==null?void 0:a.message})}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(u,{name:"email",control:l,rules:{required:"Email is required",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Invalid email address"}},render:({field:r})=>{var a;return e.jsx(j,{...r,label:"Email",fullWidth:!0,margin:"normal",error:!!i.email,helperText:(a=i.email)==null?void 0:a.message})}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(u,{name:"phone",control:l,rules:{pattern:{value:/^[0-9]{10}$/,message:"Invalid phone number"}},render:({field:r})=>{var a;return e.jsx(j,{...r,label:"Phone Number",fullWidth:!0,margin:"normal",error:!!i.phone,helperText:(a=i.phone)==null?void 0:a.message})}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(u,{name:"organizationId",control:l,rules:{required:"Organization is required"},render:({field:r})=>{var a;return e.jsxs(M,{fullWidth:!0,margin:"normal",error:!!i.organizationId,children:[e.jsx(W,{children:"Organization"}),e.jsx(_,{...r,label:"Organization",renderValue:o=>e.jsx(D,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:o.map(f=>{var p;return e.jsx(z,{component:"span",variant:"body2",children:(p=h==null?void 0:h.find(d=>d.id===f))==null?void 0:p.name},f)})}),children:h==null?void 0:h.map(o=>e.jsx(v,{value:o.id,children:o.name},o.id))}),e.jsx(H,{children:(a=i.organizationId)==null?void 0:a.message})]})}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(u,{name:"qualifications",control:l,rules:{required:"Qualifications is required"},render:({field:r})=>{var a;return e.jsx(j,{...r,label:"Qualifications",fullWidth:!0,margin:"normal",error:!!i.qualifications,helperText:(a=i.qualifications)==null?void 0:a.message})}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(u,{name:"experience",control:l,rules:{required:"Experience is required"},render:({field:r})=>{var a;return e.jsx(j,{...r,label:"Experience",fullWidth:!0,margin:"normal",error:!!i.experience,helperText:(a=i.experience)==null?void 0:a.message})}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(u,{name:"officeHours",control:l,rules:{required:"Office Hours is required"},render:({field:r})=>{var a;return e.jsx(j,{...r,label:"Office Hours",fullWidth:!0,margin:"normal",error:!!i.officeHours,helperText:(a=i.officeHours)==null?void 0:a.message})}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(u,{name:"specialResponsibilities",control:l,rules:{required:"Special Responsibilities is required"},render:({field:r})=>{var a;return e.jsx(j,{...r,label:"Special Responsibilities",fullWidth:!0,margin:"normal",error:!!i.specialResponsibilities,helperText:(a=i.specialResponsibilities)==null?void 0:a.message})}})}),e.jsx(c,{item:!0,xs:12,children:e.jsxs(D,{sx:{display:"flex",justifyContent:"flex-end",gap:2,mt:2},children:[e.jsx(F,{variant:"outlined",color:"primary",onClick:()=>{y(g),n()},children:"Cancel"}),e.jsx(F,{type:"submit",variant:"contained",color:"primary",children:"Save"})]})})]})})};function Te(){const t=K(),s=N(d=>d.teacher.data),n=T.useMemo(()=>[{field:"name",headerName:"Teacher Name",flex:1,editable:!0,headerClassName:"theme--header"},{field:"phone",headerName:"Contact Phone",flex:1,editable:!0,headerClassName:"theme--header"},{field:"subjects",headerName:"Subjects",flex:1,editable:!0,headerClassName:"theme--header"},{field:"qualifications",headerName:"Qualifications",flex:1,editable:!0,headerClassName:"theme--header"},{field:"coursesTaught",headerName:"Courses Taught",flex:1,editable:!0,headerClassName:"theme--header"},{field:"createdAt",headerName:"Created At",flex:1,editable:!1,headerClassName:"theme--header"},{field:"updatedAt",headerName:"Updated At",flex:1,editable:!1,headerClassName:"theme--header"}],[]),[m,S]=T.useState({}),[x,h]=T.useState(""),[g,l]=T.useState(null),[R,i]=T.useState(!1),{loading:y}=N(d=>d.teacher);T.useEffect(()=>{t(A.fetchTeachers())},[t]);const w=()=>{l(null),h("Add Teacher"),f()},I=d=>{const O=s==null?void 0:s.teachers.find(B=>B._id===d);l(O||null),h("Edit Teacher"),f()},r=async d=>{t(A.deleteTeachers(d))},a=async d=>{t(g?A.updateTeachers({...d,_id:g._id}):A.createTeachers(d)),p()},o=()=>{t(A.fetchTeachers())},f=()=>i(!0),p=()=>i(!1);return e.jsxs(D,{sx:{width:"100%",height:"100%"},children:[e.jsx(V,{columns:n,onAdd:w,onDelete:r,onEdit:I,rows:(s==null?void 0:s.teachers)??[],rowModesModel:m,setRowModesModel:S,loading:y,reloadData:o}),e.jsx(ee,{open:R,onClose:p,title:x,children:e.jsx(ie,{initialValues:g,onSubmit:a,onClose:p})})]})}export{Te as default};
