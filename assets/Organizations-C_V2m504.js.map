{"version":3,"mappings":"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","names":["fetchOrganizations","params","dispatch","queryParams","parseQueryParams","fetchOrganizationsStart","response","AsyncorganizationApi","fetchOrganizationsSuccess","error","toast","_b","_a","fetchOrganizationById","id","fetchOrganizationByIdStart","fetchOrganizationByIdSuccess","createOrganization","organization","createOrganizationStart","createOrganizationSuccess","updateOrganization","updateOrganizationStart","updateOrganizationSuccess","deleteOrganization","deleteOrganizationStart","deleteOrganizationSuccess","organizationActions","OrganizationForm","lazy","GenericModal","__vitePreload","Organizations","useDispatch","columns","useMemo","rowModesModel","setRowModesModel","useState","open","setOpen","modalTitle","setModalTitle","selectedRow","setSelectedRow","organizations","loading","useSelector","state","user","accessibleOrganizations","org","hasPermission","fetchOrganizationsCallback","useCallback","setParams","usePaginationParams","onParamasChange","handleAdd","handleOpen","handleEdit","selectedOrganization","handleDelete","handleSave","data","handleClose","handleReloadData","totalRows","jsxs","Box","jsx","ReusableDataGrid","Suspense"],"ignoreList":[],"sources":["../../src/redux/actions/organization.actions.ts","../../src/pages/Organizations.tsx"],"sourcesContent":["//create organization actions to dispatch\nimport { organizationApi } from '../../api/organization.api';\nimport { Organization } from '../../models/organization.modal';\nimport { AppDispatch } from '../store';\nimport { createOrganizationStart, createOrganizationSuccess, deleteOrganizationStart, deleteOrganizationSuccess, fetchOrganizationByIdStart, fetchOrganizationByIdSuccess, fetchOrganizationsStart, fetchOrganizationsSuccess, updateOrganizationStart, updateOrganizationSuccess } from '../slices/organization.slice';\nimport { toast } from 'react-toastify';\nimport { AsyncorganizationApi } from '@api/api';\nimport { Params } from '@models/pagination.modals';\nimport { parseQueryParams } from '@utils/parseQueryParams';\n\nconst fetchOrganizations = (params: Params) => async (dispatch: AppDispatch) => {\n    try {\n        const queryParams = parseQueryParams(params);\n\n        dispatch(fetchOrganizationsStart());\n        const response = await AsyncorganizationApi.getOrganizations(queryParams);\n        console.log(response)\n        dispatch(fetchOrganizationsSuccess(response.data.data));\n    } catch (error) {\n        toast.error(error.response?.data?.data || 'Failed to fetch organizations', {\n            autoClose: 3000,\n        });\n    }\n};\n\nconst fetchOrganizationById = (id: string) => async (dispatch: AppDispatch) => {\n    try {\n        dispatch(fetchOrganizationByIdStart()); // Set loading state to true\n        const response = await AsyncorganizationApi.getOrganizationById(id);\n        // console.log(response.data)\n        dispatch(fetchOrganizationByIdSuccess(response.data.data)); // Pass data to success action\n    } catch (error) {\n        toast.error(error.response.data.data || 'Failed to fetch organization', {\n            autoClose: 3000, // Auto close after 3 seconds\n        });\n    }\n};\n\nconst createOrganization = (organization: Omit<Organization, 'createdAt' | 'updatedAt'>) => async (dispatch: AppDispatch) => {\n    try {\n        dispatch(createOrganizationStart()); // Set loading state to true\n        const response = await AsyncorganizationApi.createOrganization(organization);\n        dispatch(createOrganizationSuccess(response.data.data)); // Pass data to success action\n        return response.data;\n    } catch (error) {\n        toast.error(error.response.data.data || 'Failed to fetch organization', {\n            autoClose: 3000, // Auto close after 3 seconds\n        });\n    }\n};\n\nconst updateOrganization = (organization: Omit<Organization, 'createdAt' | 'updatedAt'>) => async (dispatch: AppDispatch) => {\n    try {\n        // console.log(organization)\n        dispatch(updateOrganizationStart()); // Set loading state to true\n        const response = await AsyncorganizationApi.updateOrganization(organization, organization.id);\n        dispatch(updateOrganizationSuccess(response.data.data)); // Pass data to success action\n        return response.data;\n    } catch (error) {\n        toast.error(error.response.data.data || 'Failed to fetch organization', {\n            autoClose: 3000, // Auto close after 3 seconds\n        });\n    }\n};\n\nconst deleteOrganization = (id: string) => async (dispatch: AppDispatch) => {\n    try {\n        dispatch(deleteOrganizationStart());\n        const response = await AsyncorganizationApi.deleteOrganization(id);\n        dispatch(deleteOrganizationSuccess(id));\n        toast.info('Organization deleted successfully', {\n            autoClose: 3000,\n        });\n    } catch (error) {\n        toast.error((error as { response?: { data?: { data?: string } } })?.response?.data?.data || 'Failed to fetch organization', {\n            autoClose: 3000,\n        });\n    }\n};\n\n\nexport const organizationActions = {\n    fetchOrganizations,\n    fetchOrganizationById,\n    createOrganization,\n    updateOrganization,\n    deleteOrganization,\n}","import { GridColDef, GridRowId, GridRowModesModel } from '@mui/x-data-grid'\nimport { lazy, Suspense, useCallback, useMemo, useState } from 'react'\nimport { Box } from '@mui/material'\nimport { AppDispatch, RootState } from '@redux/store'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { hasPermission } from \"@utils/auth.ts\";\nimport { organizationActions } from \"@redux/actions/organization.actions.ts\";\nimport { ReusableDataGrid } from \"@components/ReusableDataGrid.tsx\";\nimport { Params } from '@models/pagination.modals'\nimport { usePaginationParams } from '@hooks/usePaginationParams'\nconst OrganizationForm = lazy(() => import(\"@components/Forms/OrganizationForm\"));\nconst GenericModal = lazy(() => import(\"@components/GenericModal\"));\n\n/**\n * Organizations component displays a data grid of organizations with CRUD operations.\n * \n * @returns The Organizations component.\n */\nfunction Organizations() {\n\n    const dispatch = useDispatch<AppDispatch>()\n\n    /**\n     * Defines the columns for the data grid.\n     * \n     * @returns An array of column definitions.\n     */\n    const columns: GridColDef[] = useMemo(() => [\n        { field: 'name', headerName: 'Name', flex: 1, editable: true, headerClassName: 'theme--header' },\n        { field: 'category', headerName: 'Category', flex: 1, editable: true, headerClassName: 'theme--header' },\n        { field: 'number', headerName: 'Number', flex: 1, editable: true, headerClassName: 'theme--header' },\n        { field: 'contactEmail', headerName: 'Contact Email', flex: 1, editable: true, headerClassName: 'theme--header' },\n        { field: 'contactPhone', headerName: 'Contact Phone', flex: 1, editable: true, headerClassName: 'theme--header' },\n        // {field: 'website', headerName: 'Website', flex: 1, editable: true, headerClassName: 'theme--header'},\n        // {field: 'logo', headerName: 'Logo', flex: 1, editable: true, headerClassName: 'theme--header'},\n        {\n            field: 'establishedDate',\n            headerName: 'Established Date',\n            flex: 1,\n            editable: true,\n            headerClassName: 'theme--header'\n        },\n        { field: 'description', headerName: 'Description', flex: 1, editable: true, headerClassName: 'theme--header' },\n    ], []);\n\n    const [rowModesModel, setRowModesModel] = useState<GridRowModesModel>({});\n    const [open, setOpen] = useState(false);\n    const [modalTitle, setModalTitle] = useState<string | undefined>(undefined);\n    const [selectedRow, setSelectedRow] = useState<any>(null);\n    const { data: organizations, loading } = useSelector((state: RootState) => state.organization);\n    const user = useSelector((state: RootState) => state.auth.user);\n\n    /**\n     * Filters organizations based on user permissions.\n     * \n     * @returns An array of accessible organizations.\n     */\n    const accessibleOrganizations = useMemo(() => {\n        if (!user || !organizations?.organizations) return [];\n        return organizations.organizations.filter((org) =>\n            hasPermission(user, \"organizations\", \"view\", org)\n        );\n    }, [user, organizations]);\n\n    const fetchOrganizationsCallback = useCallback(\n        (params: Params) => {\n            dispatch(organizationActions.fetchOrganizations(params));\n        },\n        [dispatch]\n    );\n\n    const { params, setParams } = usePaginationParams(\n        {\n            page: 1,\n            limit: 10,\n            sortBy: undefined,\n            sortOrder: undefined,\n            searchTerm: undefined,\n            filters: {},\n        },\n        fetchOrganizationsCallback\n    );\n\n    const onParamasChange = (params: Params) => {\n        setParams(params);\n    };\n    /**\n     * Handles the add organization action.\n     */\n    const handleAdd = () => {\n        setSelectedRow(null);\n        setModalTitle('Add Organization');\n        handleOpen();\n    };\n\n    /**\n     * Handles the edit organization action.\n     * \n     * @param {GridRowId} id - The ID of the organization to edit.\n     */\n    const handleEdit = (id: GridRowId) => {\n        const selectedOrganization = organizations?.organizations.find((org: any) => org._id === id); // Find the row by ID\n        console.log(\"selectedOrganization\", selectedOrganization)\n        setSelectedRow(selectedOrganization);\n        setModalTitle('Edit Organization');\n        handleOpen()\n    };\n\n    /**\n     * Handles the delete organization action.\n     * \n     * @param {string} id - The ID of the organization to delete.\n     */\n    const handleDelete = async (id: string) => {\n        dispatch(organizationActions.deleteOrganization(id));\n    };\n\n    /**\n     * Handles the save organization action.\n     * \n     * @param {any} data - The data to save.\n     */\n    const handleSave = async (data: any) => {\n        if (selectedRow) {\n            dispatch(organizationActions.updateOrganization({ id: selectedRow._id, ...data }));\n        } else {\n            dispatch(organizationActions.createOrganization(data));\n        }\n        handleClose();\n    };\n\n    /**\n     * Handles the reload data action.\n     */\n    const handleReloadData = () => {\n        dispatch(organizationActions.fetchOrganizations(params));\n    };\n\n    /**\n     * Opens the modal.\n     */\n    const handleOpen = () => setOpen(true);\n    /**\n     * Closes the modal.\n     */\n    const handleClose = () => setOpen(false);\n\n    const totalRows = organizations?.totalOrganizations || 0;\n\n    return (\n        <Box sx={{\n            width: '100%',\n            height: '100%',\n            minWidth: 0, // Add min-width constraint\n            overflow: 'hidden',\n        }}>\n            <ReusableDataGrid\n                columns={columns}\n                onAdd={handleAdd}\n                onDelete={handleDelete}\n                onEdit={handleEdit}\n                rows={accessibleOrganizations ?? []}\n                rowModesModel={rowModesModel}\n                setRowModesModel={setRowModesModel}\n                loading={loading}\n                reloadData={handleReloadData}\n                totalRows={totalRows}\n                paginationModel={{\n                    page: params.page - 1, // if DataGrid is 0-based\n                    pageSize: params.limit,\n                }}\n                onParamsChange={(params) => onParamasChange(params)}\n            />\n            {open && (\n                <Suspense fallback={<div>Loading modal...</div>}>\n                    <GenericModal\n                        open={open}\n                        onClose={handleClose}\n                        title={modalTitle}\n                    >\n                        <Suspense fallback={<div>Loading form...</div>}>\n                            <OrganizationForm\n                                initialValues={selectedRow}\n                                onSubmit={handleSave}\n                                onClose={handleClose}\n                            />\n                        </Suspense>\n                    </GenericModal>\n                </Suspense>\n            )}\n        </Box>\n    );\n}\n\nexport default Organizations;"],"file":"assets/Organizations-C_V2m504.js"}