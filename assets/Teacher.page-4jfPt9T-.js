import{A as V,$ as J,a0 as I,a1 as K,a2 as q,G as C,a3 as X,a4 as ee,a5 as ae,a6 as re,a7 as se,a8 as te,a9 as ne,aa as ie,o as v,r as j,y as P,j as e,Y as M,T as O,B as _,z as W,ab as oe,Q as le,p as de,ac as ce,ad as ue}from"./index-CGCMCOQF.js";import{u as me,C as m,a as he,R as fe,G as pe}from"./usePaginationParams-ya55zGI1.js";import{G as c}from"./Grid-DLbuif_v.js";import{F as B,I as H,S as Y,a as G,T as x}from"./TextField-CBUoArC1.js";import"./reselect-CyGGQztN.js";import"./styled-D1FPqb-5.js";import"./InputAdornment-BAa8utJI.js";import"./Checkbox-EFVU1dKg.js";import"./FormControlLabel-DH_MT0wL.js";import"./KeyboardArrowRight-BUEHFlUs.js";import"./CircularProgress-C0z7Gm7B.js";try{let n=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},t=new n.Error().stack;t&&(n._sentryDebugIds=n._sentryDebugIds||{},n._sentryDebugIds[t]="eaf2ac15-43b3-4957-b8ef-e79df35cccb7",n._sentryDebugIdIdentifier="sentry-dbid-eaf2ac15-43b3-4957-b8ef-e79df35cccb7")}catch{}const xe=n=>async t=>{var a,f;try{const h=V(n);t(J());const u=await I.getTeachers(h);t(K(u.data.data))}catch(h){t(q()),C.error(((f=(a=h.response)==null?void 0:a.data)==null?void 0:f.data)||"Failed to fetch organizations",{autoClose:3e3})}},ge=n=>async t=>{try{t(ne());const a=await I.getTeacherById(n);t(ie(a.data.data))}catch(a){t(q()),C.error(a.response.data.data||"Failed to fetch organization",{autoClose:3e3})}},je=n=>async t=>{try{t(se());const a=await I.createTeacher(n);return t(te(a.data.data)),a.data}catch(a){t(q()),C.error(a.response.data.data||"Failed to fetch organization",{autoClose:3e3})}},Te=n=>async t=>{try{if(t(ae()),n._id){const a=await I.updateTeacher(n,n._id);return t(re(a.data.data)),a.data}else throw new Error("Teacher ID is required for update")}catch(a){t(q()),a instanceof Error&&C.error(a.message||"Failed to fetch organization",{autoClose:3e3})}},be=n=>async t=>{try{t(X());const a=await I.deleteTeacher(n);t(ee(n)),C.info(a.message||"Organization deleted successfully",{autoClose:3e3})}catch(a){t(q()),console.log(a),C.error(a.response.data.data||"Failed to fetch organization",{autoClose:3e3})}},S={fetchTeachers:xe,fetchTeacherById:ge,createTeachers:je,updateTeachers:Te,deleteTeachers:be},ye=({initialValues:n,onSubmit:t,onClose:a})=>{var N;const{data:f}=v(r=>r.user),{data:h}=v(r=>r.organization),u=(N=f==null?void 0:f.users)==null?void 0:N.filter(r=>r.role==="TEACHER"),p=h==null?void 0:h.organizations,A={_id:"",userId:"",name:"",phone:"",email:"",organizationId:"",organizations:[],departments:[],subjects:[],qualifications:"",experience:0,officeHours:"",coursesTaught:[],performanceReviews:[],specialResponsibilities:"",createdAt:null,updatedAt:null},{control:d,handleSubmit:w,formState:{errors:i},reset:T}=me({defaultValues:A});j.useEffect(()=>{n&&T({...n,createdAt:n.createdAt?P(n.createdAt):null,updatedAt:n.updatedAt?P(n.updatedAt):null})},[n,T]);const z=r=>{const s={...r,createdAt:r.createdAt?r.createdAt.format("YYYY-MM-DD"):null,updatedAt:r.updatedAt?r.updatedAt.format("YYYY-MM-DD"):null};t(s)};return e.jsx("form",{onSubmit:w(z),children:e.jsxs(c,{container:!0,spacing:2,children:[e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(m,{name:"userId",control:d,rules:{required:"User ID is required"},render:({field:r})=>{var s;return e.jsxs(B,{fullWidth:!0,margin:"normal",error:!!i.userId,children:[e.jsx(H,{children:"User ID"}),e.jsx(Y,{...r,label:"User ID",renderValue:l=>{var g;return e.jsx(O,{variant:"body2",children:(g=u==null?void 0:u.find(b=>b._id===l))==null?void 0:g.username})},children:u==null?void 0:u.map(l=>e.jsx(M,{value:l._id,children:l.username},l._id))}),e.jsx(G,{children:(s=i.userId)==null?void 0:s.message})]})}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(m,{name:"name",control:d,rules:{required:"Name is required"},render:({field:r})=>{var s;return e.jsx(x,{...r,label:"Name",fullWidth:!0,margin:"normal",error:!!i.name,helperText:(s=i.name)==null?void 0:s.message})}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(m,{name:"phone",control:d,rules:{required:"Phone is required",pattern:{value:/^[0-9]{10}$/,message:"Invalid phone number"}},render:({field:r})=>{var s;return e.jsx(x,{...r,label:"Phone Number",fullWidth:!0,margin:"normal",error:!!i.phone,helperText:(s=i.phone)==null?void 0:s.message})}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(m,{name:"email",control:d,rules:{required:"Email is required",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Invalid email address"}},render:({field:r})=>{var s;return e.jsx(x,{...r,label:"Email",fullWidth:!0,margin:"normal",error:!!i.email,helperText:(s=i.email)==null?void 0:s.message})}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(m,{name:"phone",control:d,rules:{pattern:{value:/^[0-9]{10}$/,message:"Invalid phone number"}},render:({field:r})=>{var s;return e.jsx(x,{...r,label:"Phone Number",fullWidth:!0,margin:"normal",error:!!i.phone,helperText:(s=i.phone)==null?void 0:s.message})}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(m,{name:"organizationId",control:d,rules:{required:"Organization is required"},render:({field:r})=>{var s;return e.jsxs(B,{fullWidth:!0,margin:"normal",error:!!i.organizationId,children:[e.jsx(H,{children:"Organization"}),e.jsx(Y,{...r,label:"Organization",renderValue:l=>e.jsx(_,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:l.map(g=>{var b;return e.jsx(O,{component:"span",variant:"body2",children:(b=p==null?void 0:p.find(D=>D.id===g))==null?void 0:b.name},g)})}),children:p==null?void 0:p.map(l=>e.jsx(M,{value:l.id,children:l.name},l.id))}),e.jsx(G,{children:(s=i.organizationId)==null?void 0:s.message})]})}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(m,{name:"qualifications",control:d,rules:{required:"Qualifications is required"},render:({field:r})=>{var s;return e.jsx(x,{...r,label:"Qualifications",fullWidth:!0,margin:"normal",error:!!i.qualifications,helperText:(s=i.qualifications)==null?void 0:s.message})}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(m,{name:"experience",control:d,rules:{required:"Experience is required"},render:({field:r})=>{var s;return e.jsx(x,{...r,label:"Experience",fullWidth:!0,margin:"normal",error:!!i.experience,helperText:(s=i.experience)==null?void 0:s.message})}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(m,{name:"officeHours",control:d,rules:{required:"Office Hours is required"},render:({field:r})=>{var s;return e.jsx(x,{...r,label:"Office Hours",fullWidth:!0,margin:"normal",error:!!i.officeHours,helperText:(s=i.officeHours)==null?void 0:s.message})}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(m,{name:"specialResponsibilities",control:d,rules:{required:"Special Responsibilities is required"},render:({field:r})=>{var s;return e.jsx(x,{...r,label:"Special Responsibilities",fullWidth:!0,margin:"normal",error:!!i.specialResponsibilities,helperText:(s=i.specialResponsibilities)==null?void 0:s.message})}})}),e.jsx(c,{item:!0,xs:12,children:e.jsxs(_,{sx:{display:"flex",justifyContent:"flex-end",gap:2,mt:2},children:[e.jsx(W,{variant:"outlined",color:"primary",onClick:()=>{T(A),a()},children:"Cancel"}),e.jsx(W,{type:"submit",variant:"contained",color:"primary",children:"Save"})]})})]})})};function _e(){const n=oe(),t=le(),a=v(o=>o.teacher.data),f=j.useMemo(()=>[{field:"name",headerName:"Teacher Name",flex:1,editable:!0,headerClassName:"theme--header"},{field:"phone",headerName:"Contact Phone",flex:1,editable:!0,headerClassName:"theme--header"},{field:"subjects",headerName:"Subjects",flex:1,editable:!0,headerClassName:"theme--header"},{field:"qualifications",headerName:"Qualifications",flex:1,editable:!0,headerClassName:"theme--header"},{field:"coursesTaught",headerName:"Courses Taught",flex:1,editable:!0,headerClassName:"theme--header"},{field:"createdAt",headerName:"Created At",flex:1,editable:!1,headerClassName:"theme--header"},{field:"updatedAt",headerName:"Updated At",flex:1,editable:!1,headerClassName:"theme--header"}],[]),[h,u]=j.useState({}),[p,A]=j.useState(""),[d,w]=j.useState(null),[i,T]=j.useState(!1),N=de().pathname.includes("/teachers/profile"),{loading:r}=v(o=>o.teacher),s=j.useCallback(o=>{t(S.fetchTeachers(o))},[t]),{params:l,setParams:g}=he({page:1,limit:10,sortBy:void 0,sortOrder:void 0,searchTerm:void 0,filters:{}},s),b=o=>{g(o)},D=()=>{w(null),A("Add Teacher"),F()},Q=o=>{const y=a==null?void 0:a.teachers.find(E=>E._id===o);w(y||null),A("Edit Teacher"),F()},k=o=>{const y=a==null?void 0:a.teachers.find(E=>E._id===o);y&&n(ue.TEACHER_PROFILE.replace(":id",y==null?void 0:y._id))},U=async o=>{t(S.deleteTeachers(o))},$=async o=>{t(d?S.updateTeachers({...o,_id:d._id}):S.createTeachers(o)),R()},L=()=>{t(S.fetchTeachers(l))},F=()=>T(!0),R=()=>T(!1),Z=(a==null?void 0:a.totalTeachers)||0;return e.jsx(_,{sx:{width:"100%",height:"100%"},children:N?e.jsx(ce,{}):e.jsxs(e.Fragment,{children:[e.jsx(fe,{columns:f,onAdd:D,onDelete:U,onEdit:Q,rows:(a==null?void 0:a.teachers)??[],rowModesModel:h,setRowModesModel:u,loading:r,reloadData:L,totalRows:Z,paginationModel:{page:l.page-1,pageSize:l.limit},onParamsChange:b,onView:k}),e.jsx(pe,{open:i,onClose:R,title:p,children:e.jsx(ye,{initialValues:d,onSubmit:$,onClose:R})})]})})}export{_e as default};
//# sourceMappingURL=Teacher.page-4jfPt9T-.js.map
