import{a as H,g as K,r as y,b as X,j as e,s as N,c as J,L as C,d as Q,m as B,e as W,M as V,N as ee,O as re,K as P,o as I,Q as w,B as O,T as $,p as E,J as ae,U as A}from"./index-SRrTBXCC.js";import{u as se,C as d,a as te,R as le,G as ie}from"./usePaginationParams-DxAbNu5X.js";import{G as n}from"./Grid-Gh5MVjop.js";import{T as b,F as T,I as U,S as D,a as M}from"./TextField-Ck7cFlxI.js";import{D as ne}from"./DatePicker-Dnj570HZ.js";import{S as oe,F as de}from"./FormControlLabel-BJOqXBEo.js";import"./useId-CZ066Zps.js";import"./reselect-fumL3tiG.js";import"./Popper-DBdlVSYc.js";import"./Tooltip-CARQlZDD.js";import"./Checkbox-CbKKmzbx.js";import"./KeyboardArrowRight-BPEmQlsH.js";import"./CircularProgress-MJR8981s.js";import"./Skeleton-D2PZNTa9.js";try{let r=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},l=new r.Error().stack;l&&(r._sentryDebugIds=r._sentryDebugIds||{},r._sentryDebugIds[l]="18c0175f-383a-4fd2-b34a-dda5695bf69b",r._sentryDebugIdIdentifier="sentry-dbid-18c0175f-383a-4fd2-b34a-dda5695bf69b")}catch{}function ce(r){return K("MuiSwitch",r)}const p=H("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]),me=r=>{const{classes:l,edge:m,size:v,color:c,checked:f,disabled:i}=r,k={root:["root",m&&`edge${C(m)}`,`size${C(v)}`],switchBase:["switchBase",`color${C(c)}`,f&&"checked",i&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},t=Q(k,ce,l);return{...l,...t}},ue=N("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(r,l)=>{const{ownerState:m}=r;return[l.root,m.edge&&l[`edge${C(m.edge)}`],l[`size${C(m.size)}`]]}})({display:"inline-flex",width:34+12*2,height:14+12*2,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"},variants:[{props:{edge:"start"},style:{marginLeft:-8}},{props:{edge:"end"},style:{marginRight:-8}},{props:{size:"small"},style:{width:40,height:24,padding:7,[`& .${p.thumb}`]:{width:16,height:16},[`& .${p.switchBase}`]:{padding:4,[`&.${p.checked}`]:{transform:"translateX(16px)"}}}}]}),he=N(oe,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(r,l)=>{const{ownerState:m}=r;return[l.switchBase,{[`& .${p.input}`]:l.input},m.color!=="default"&&l[`color${C(m.color)}`]]}})(B(({theme:r})=>({position:"absolute",top:0,left:0,zIndex:1,color:r.vars?r.vars.palette.Switch.defaultColor:`${r.palette.mode==="light"?r.palette.common.white:r.palette.grey[300]}`,transition:r.transitions.create(["left","transform"],{duration:r.transitions.duration.shortest}),[`&.${p.checked}`]:{transform:"translateX(20px)"},[`&.${p.disabled}`]:{color:r.vars?r.vars.palette.Switch.defaultDisabledColor:`${r.palette.mode==="light"?r.palette.grey[100]:r.palette.grey[600]}`},[`&.${p.checked} + .${p.track}`]:{opacity:.5},[`&.${p.disabled} + .${p.track}`]:{opacity:r.vars?r.vars.opacity.switchTrackDisabled:`${r.palette.mode==="light"?.12:.2}`},[`& .${p.input}`]:{left:"-100%",width:"300%"}})),B(({theme:r})=>({"&:hover":{backgroundColor:r.vars?`rgba(${r.vars.palette.action.activeChannel} / ${r.vars.palette.action.hoverOpacity})`:W(r.palette.action.active,r.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},variants:[...Object.entries(r.palette).filter(V(["light"])).map(([l])=>({props:{color:l},style:{[`&.${p.checked}`]:{color:(r.vars||r).palette[l].main,"&:hover":{backgroundColor:r.vars?`rgba(${r.vars.palette[l].mainChannel} / ${r.vars.palette.action.hoverOpacity})`:W(r.palette[l].main,r.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${p.disabled}`]:{color:r.vars?r.vars.palette.Switch[`${l}DisabledColor`]:`${r.palette.mode==="light"?ee(r.palette[l].main,.62):re(r.palette[l].main,.55)}`}},[`&.${p.checked} + .${p.track}`]:{backgroundColor:(r.vars||r).palette[l].main}}}))]}))),pe=N("span",{name:"MuiSwitch",slot:"Track",overridesResolver:(r,l)=>l.track})(B(({theme:r})=>({height:"100%",width:"100%",borderRadius:14/2,zIndex:-1,transition:r.transitions.create(["opacity","background-color"],{duration:r.transitions.duration.shortest}),backgroundColor:r.vars?r.vars.palette.common.onBackground:`${r.palette.mode==="light"?r.palette.common.black:r.palette.common.white}`,opacity:r.vars?r.vars.opacity.switchTrack:`${r.palette.mode==="light"?.38:.3}`}))),xe=N("span",{name:"MuiSwitch",slot:"Thumb",overridesResolver:(r,l)=>l.thumb})(B(({theme:r})=>({boxShadow:(r.vars||r).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"}))),ge=y.forwardRef(function(l,m){const v=X({props:l,name:"MuiSwitch"}),{className:c,color:f="primary",edge:i=!1,size:k="medium",sx:t,...z}=v,S={...v,color:f,edge:i,size:k},o=me(S),a=e.jsx(xe,{className:o.thumb,ownerState:S});return e.jsxs(ue,{className:J(o.root,c),sx:t,ownerState:S,children:[e.jsx(he,{type:"checkbox",icon:a,checkedIcon:a,ref:m,ownerState:S,...z,classes:{...o,root:o.switchBase}}),e.jsx(pe,{className:o.track,ownerState:S})]})}),fe=({initialValues:r,onSubmit:l,onClose:m})=>{var o;const{data:v}=P(a=>a.organization),c=(o=v==null?void 0:v.organizations)==null?void 0:o.map(a=>({id:a._id,name:a.name})),f={_id:"",organizations:c||[],organizationId:c?c[0].id:"",username:"",email:"",fullname:"",avatar:"",coverImage:"",age:"",role:"STUDENT",gender:"male",phone:"",address:{street:"",city:"",state:"",zip:"",country:""},status:"active",dateOfBirth:null,biography:"",permissions:[],socialLinks:{facebook:"",twitter:"",linkedin:"",instagram:""},preferences:{notifications:!0,language:"en",theme:"light",timezone:"Asia/Kolkata",currency:"INR",dateFormat:"DD/MM/YYYY"},createdAt:null,updatedAt:null},{control:i,handleSubmit:k,formState:{errors:t},reset:z}=se({defaultValues:f});y.useEffect(()=>{r&&z({...r,dateOfBirth:r.dateOfBirth?I(r.dateOfBirth):null,createdAt:r.createdAt?I(r.createdAt):null,updatedAt:r.updatedAt?I(r.updatedAt):null})},[r,z]);const S=a=>{const s={...a,dateOfBirth:a.dateOfBirth?a.dateOfBirth.format("YYYY-MM-DD"):null,createdAt:a.createdAt?a.createdAt.format("YYYY-MM-DD"):null,updatedAt:a.updatedAt?a.updatedAt.format("YYYY-MM-DD"):null,organizations:a.organizations,organizationId:a.organizations?a.organizations[0].id:""};l(s)};return e.jsx("form",{onSubmit:k(S),children:e.jsxs(n,{container:!0,spacing:2,children:[e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(d,{name:"username",control:i,rules:{required:"Username is required"},render:({field:a})=>{var s;return e.jsx(b,{...a,label:"Username",size:"small",fullWidth:!0,margin:"normal",error:!!t.username,helperText:(s=t.username)==null?void 0:s.message})}})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(d,{name:"fullname",control:i,rules:{required:"Full name is required"},render:({field:a})=>{var s;return e.jsx(b,{...a,label:"Full Name",size:"small",fullWidth:!0,margin:"normal",error:!!t.fullname,helperText:(s=t.fullname)==null?void 0:s.message})}})}),e.jsx(n,{item:!0,xs:12,children:e.jsx(d,{name:"organizations",control:i,rules:{required:"At least one organization is required"},render:({field:a})=>{var s;return e.jsxs(T,{fullWidth:!0,margin:"normal",error:!!t.organizations,children:[e.jsx(U,{children:"Organizations"}),e.jsx(D,{...a,multiple:!0,label:"Organizations",size:"small",renderValue:u=>e.jsx(O,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:u.map(x=>{var g;return e.jsx($,{component:"span",variant:"body2",children:(g=c==null?void 0:c.find(j=>j.id===x))==null?void 0:g.name},x)})}),children:c==null?void 0:c.map(u=>e.jsx(w,{value:u.id,children:u.name},u.id))}),e.jsx(M,{children:(s=t.organizations)==null?void 0:s.message})]})}})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(d,{name:"email",size:"small",control:i,rules:{required:"Email is required",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Invalid email address"}},render:({field:a})=>{var s;return e.jsx(b,{...a,label:"Email",size:"small",fullWidth:!0,margin:"normal",error:!!t.email,helperText:(s=t.email)==null?void 0:s.message})}})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(d,{name:"age",control:i,rules:{required:"Age is required",pattern:{value:/^[0-9]+$/,message:"Age must be a number"}},render:({field:a})=>{var s;return e.jsx(b,{...a,label:"Age",size:"small",fullWidth:!0,margin:"normal",error:!!t.age,helperText:(s=t.age)==null?void 0:s.message})}})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(d,{name:"role",control:i,rules:{required:"Role is required"},render:({field:a})=>{var s;return e.jsxs(T,{fullWidth:!0,margin:"normal",error:!!t.role,size:"small",children:[e.jsx(U,{children:"Role"}),e.jsxs(D,{...a,label:"Role",children:[e.jsx(w,{value:"ADMIN",children:"Admin"}),e.jsx(w,{value:"TEACHER",children:"Teacher"}),e.jsx(w,{value:"STUDENT",children:"Student"}),e.jsx(w,{value:"PARENT",children:"Parent"})]}),e.jsx(M,{children:(s=t.role)==null?void 0:s.message})]})}})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(d,{name:"gender",control:i,rules:{required:"Gender is required"},render:({field:a})=>{var s;return e.jsxs(T,{fullWidth:!0,margin:"normal",error:!!t.gender,size:"small",children:[e.jsx(U,{children:"Gender"}),e.jsxs(D,{...a,label:"Gender",children:[e.jsx(w,{value:"male",children:"Male"}),e.jsx(w,{value:"female",children:"Female"}),e.jsx(w,{value:"other",children:"Other"})]}),e.jsx(M,{children:(s=t.gender)==null?void 0:s.message})]})}})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(d,{name:"phone",control:i,rules:{pattern:{value:/^[0-9]{10}$/,message:"Invalid phone number"}},render:({field:a})=>{var s;return e.jsx(b,{...a,label:"Phone",size:"small",fullWidth:!0,margin:"normal",error:!!t.phone,helperText:(s=t.phone)==null?void 0:s.message})}})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(d,{name:"avatar",control:i,render:({field:a})=>{var s;return e.jsx(b,{...a,label:"Avatar URL",size:"small",fullWidth:!0,margin:"normal",error:!!t.avatar,helperText:(s=t.avatar)==null?void 0:s.message})}})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(d,{name:"coverImage",control:i,render:({field:a})=>{var s;return e.jsx(b,{...a,label:"Cover Image URL",size:"small",fullWidth:!0,margin:"normal",error:!!t.coverImage,helperText:(s=t.coverImage)==null?void 0:s.message})}})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(d,{name:"dateOfBirth",control:i,render:({field:a})=>{var s;return e.jsx(ne,{label:"Date of Birth",value:a.value,onChange:u=>a.onChange(u),slotProps:{textField:{size:"small",fullWidth:!0,error:!!t.dateOfBirth,helperText:(s=t.dateOfBirth)==null?void 0:s.message}}})}})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(d,{name:"status",control:i,render:({field:a})=>{var s;return e.jsxs(T,{fullWidth:!0,margin:"normal",error:!!t.status,size:"small",children:[e.jsx(U,{children:"Status"}),e.jsxs(D,{...a,label:"Status",children:[e.jsx(w,{value:"active",children:"Active"}),e.jsx(w,{value:"inactive",children:"Inactive"})]}),e.jsx(M,{children:(s=t.status)==null?void 0:s.message})]})}})}),e.jsx(n,{item:!0,xs:12,children:e.jsx(d,{name:"biography",control:i,render:({field:a})=>{var s;return e.jsx(b,{...a,label:"Biography",fullWidth:!0,multiline:!0,rows:4,margin:"normal",error:!!t.biography,helperText:(s=t.biography)==null?void 0:s.message})}})}),e.jsx(n,{item:!0,xs:12,children:e.jsx($,{variant:"h6",children:"Address"})}),["street","city","state","zip","country"].map(a=>e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(d,{name:`address.${a}`,control:i,render:({field:{onChange:s,value:u}})=>{var x,g,j;return e.jsx(b,{label:a.charAt(0).toUpperCase()+a.slice(1),fullWidth:!0,margin:"normal",size:"small",value:u,onChange:s,error:!!((x=t.address)!=null&&x[a]),helperText:(j=(g=t.address)==null?void 0:g[a])==null?void 0:j.message})}})},a)),e.jsx(n,{item:!0,xs:12,children:e.jsx($,{variant:"h6",children:"Social Links"})}),["facebook","twitter","linkedin","instagram"].map(a=>e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(d,{name:`socialLinks.${a}`,control:i,render:({field:{onChange:s,value:u}})=>{var x,g,j;return e.jsx(b,{label:a.charAt(0).toUpperCase()+a.slice(1),fullWidth:!0,margin:"normal",size:"small",value:u,onChange:s,error:!!((x=t.socialLinks)!=null&&x[a]),helperText:(j=(g=t.socialLinks)==null?void 0:g[a])==null?void 0:j.message})}})},a)),e.jsx(n,{item:!0,xs:12,children:e.jsx($,{variant:"h6",children:"Preferences"})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(d,{name:"preferences.notifications",control:i,render:({field:{onChange:a,value:s}})=>e.jsx(de,{control:e.jsx(ge,{checked:s,onChange:a,color:"primary"}),label:"Notifications"})})}),["language","theme","timezone","currency","dateFormat"].map(a=>e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(d,{name:`preferences.${a}`,control:i,render:({field:{onChange:s,value:u}})=>{var x,g,j;return e.jsx(b,{label:a.charAt(0).toUpperCase()+a.slice(1),fullWidth:!0,margin:"normal",size:"small",value:u,onChange:s,error:!!((x=t.preferences)!=null&&x[a]),helperText:(j=(g=t.preferences)==null?void 0:g[a])==null?void 0:j.message})}})},a)),e.jsx(n,{item:!0,xs:12,children:e.jsxs(O,{sx:{display:"flex",justifyContent:"flex-end",gap:2,mt:2},children:[e.jsx(E,{variant:"outlined",color:"primary",onClick:()=>{z(f),m()},children:"Cancel"}),e.jsx(E,{type:"submit",variant:"contained",color:"primary",children:"Save"})]})})]})})};function Me(){const r=ae(),[l,m]=y.useState({}),[v,c]=y.useState(""),[f,i]=y.useState(null),[k,t]=y.useState(!1),z=y.useMemo(()=>[{field:"username",headerName:"Username",flex:1,editable:!0,headerClassName:"theme--header"},{field:"email",headerName:"Email",flex:1,editable:!0,headerClassName:"theme--header"},{field:"fullname",headerName:"Full Name",flex:1,editable:!0,headerClassName:"theme--header"},{field:"role",headerName:"Role",flex:1,editable:!0,headerClassName:"theme--header"},{field:"gender",headerName:"Gender",flex:1,editable:!0,headerClassName:"theme--header"},{field:"status",headerName:"Status",flex:1,editable:!0,headerClassName:"theme--header"}],[]),{loading:S,data:o}=P(h=>h.user),a=y.useCallback(h=>{r(A.fetchUsers(h))},[r]),{params:s,setParams:u}=te({page:1,limit:10,sortBy:void 0,sortOrder:void 0,searchTerm:void 0,filters:{}},a),x=h=>{u(h),console.log(h)},g=()=>{i(null),c("Add User"),F()},j=h=>{const G=o==null?void 0:o.users.find(Z=>Z._id===h);i(G||null),c("Edit User"),F()},Y=h=>{r(A.deleteUser(h))},q=async h=>{f!=null&&f._id?r(A.updateUser({...h,_id:f._id})):r(A.createUser(h)),R()},L=()=>{r(A.fetchUsers(s))},F=()=>t(!0),R=()=>t(!1),_=(o==null?void 0:o.totalUsers)||0;return o!=null&&o.users,e.jsxs(O,{sx:{width:"100%",height:"100%"},children:[e.jsx(le,{columns:z,onAdd:g,onEdit:j,onDelete:Y,rows:(o==null?void 0:o.users)||[],rowModesModel:l,setRowModesModel:m,loading:S,reloadData:L,totalRows:_,paginationModel:{page:s.page-1,pageSize:s.limit},onParamsChange:h=>x(h),enableSearch:!0,enableFilters:!0,enableSorting:!0,searchPlaceholder:"Search users...",pageSizeOptions:[5,10,25,50,100]}),e.jsx(ie,{open:k,onClose:R,title:v,children:e.jsx(fe,{initialValues:f,onSubmit:q,onClose:R})})]})}export{Me as default};
//# sourceMappingURL=Users.page-B8dJGnui.js.map
