import{t as ae,O as re,Q as I,U as se,V as q,y as b,W as te,X as ne,Y as ie,Z as oe,$ as le,a0 as de,a1 as ce,a2 as ue,h as F,r as j,p as M,j as e,M as O,T as W,B as P,q as B,a3 as me,L as he,a4 as pe,a5 as fe,i as xe,a6 as ge,a7 as je}from"./index-DGxU0oL6.js";import{u as Te,C as h,a as be,R as ye,G as Ce}from"./usePaginationParams-CshhdFSs.js";import{G as m}from"./Grid-45cgaYc1.js";import{F as H,I as Y,S as G,a as Q,T as g}from"./TextField-CDzvyh_9.js";import"./Save-fto9940c.js";import"./reselect-ZxUjOYBI.js";import"./InputBase-DHlpWSS0.js";import"./useFormControl-DcAZQWwM.js";import"./InputAdornment-CY0Dx_RZ.js";import"./Checkbox-TIAD79Bc.js";import"./SwitchBase-BWcfrQVz.js";import"./FormControlLabel-efiXqZSd.js";import"./KeyboardArrowRight-Cg1TlZ8P.js";import"./TableCell-D2flqHbA.js";import"./CircularProgress-BlRVG76w.js";try{let s=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},t=new s.Error().stack;t&&(s._sentryDebugIds=s._sentryDebugIds||{},s._sentryDebugIds[t]="e22ea55d-49c4-436f-9788-209d1e821f1b",s._sentryDebugIdIdentifier="sentry-dbid-e22ea55d-49c4-436f-9788-209d1e821f1b")}catch{}const Se=s=>async t=>{var n,p;try{const l=ae(s);t(re());const o=await I.getTeachers(l);t(se(o.data.data))}catch(l){t(q()),b.error(((p=(n=l.response)==null?void 0:n.data)==null?void 0:p.data)||"Failed to fetch organizations",{autoClose:3e3})}},Ae=s=>async t=>{try{t(ce());const n=await I.getTeacherById(s);t(ue(n.data.data))}catch(n){t(q()),b.error(n.response.data.data||"Failed to fetch organization",{autoClose:3e3})}},Ie=s=>async t=>{try{t(le());const n=await I.createTeacher(s);return t(de(n.data.data)),n.data}catch(n){t(q()),b.error(n.response.data.data||"Failed to fetch organization",{autoClose:3e3})}},qe=s=>async t=>{try{if(t(ie()),s._id){const n=await I.updateTeacher(s,s._id);return t(oe(n.data.data)),n.data}else throw new Error("Teacher ID is required for update")}catch(n){t(q()),n instanceof Error&&b.error(n.message||"Failed to fetch organization",{autoClose:3e3})}},we=s=>async t=>{try{t(te());const n=await I.deleteTeacher(s);t(ne(s)),b.info(n.message||"Organization deleted successfully",{autoClose:3e3})}catch(n){t(q()),console.log(n),b.error(n.response.data.data||"Failed to fetch organization",{autoClose:3e3})}},A={fetchTeachers:Se,fetchTeacherById:Ae,createTeachers:Ie,updateTeachers:qe,deleteTeachers:we},De=({initialValues:s,onSubmit:t,onClose:n})=>{var C;const{data:p}=F(a=>a.user),{data:l}=F(a=>a.organization),o=(C=p==null?void 0:p.users)==null?void 0:C.filter(a=>a.role==="TEACHER"),f=l==null?void 0:l.organizations,w={_id:"",userId:"",name:"",phone:"",email:"",organizationId:"",organizations:[],departments:[],subjects:[],qualifications:"",experience:0,officeHours:"",coursesTaught:[],performanceReviews:[],specialResponsibilities:"",createdAt:null,updatedAt:null},{control:u,handleSubmit:D,formState:{errors:i},reset:y}=Te({defaultValues:w});j.useEffect(()=>{s&&y({...s,createdAt:s.createdAt?M(s.createdAt):null,updatedAt:s.updatedAt?M(s.updatedAt):null})},[s,y]);const N=a=>{const r={...a,createdAt:a.createdAt?a.createdAt.format("YYYY-MM-DD"):null,updatedAt:a.updatedAt?a.updatedAt.format("YYYY-MM-DD"):null};t(r)};return e.jsx("form",{onSubmit:D(N),children:e.jsxs(m,{container:!0,spacing:2,children:[e.jsx(m,{item:!0,xs:12,md:6,children:e.jsx(h,{name:"userId",control:u,rules:{required:"User ID is required"},render:({field:a})=>{var r;return e.jsxs(H,{fullWidth:!0,margin:"normal",error:!!i.userId,children:[e.jsx(Y,{children:"User ID"}),e.jsx(G,{...a,label:"User ID",renderValue:c=>{var x;return e.jsx(W,{variant:"body2",children:(x=o==null?void 0:o.find(S=>S._id===c))==null?void 0:x.username})},children:o==null?void 0:o.map(c=>e.jsx(O,{value:c._id,children:c.username},c._id))}),e.jsx(Q,{children:(r=i.userId)==null?void 0:r.message})]})}})}),e.jsx(m,{item:!0,xs:12,md:6,children:e.jsx(h,{name:"name",control:u,rules:{required:"Name is required"},render:({field:a})=>{var r;return e.jsx(g,{...a,label:"Name",fullWidth:!0,margin:"normal",error:!!i.name,helperText:(r=i.name)==null?void 0:r.message})}})}),e.jsx(m,{item:!0,xs:12,md:6,children:e.jsx(h,{name:"phone",control:u,rules:{required:"Phone is required",pattern:{value:/^[0-9]{10}$/,message:"Invalid phone number"}},render:({field:a})=>{var r;return e.jsx(g,{...a,label:"Phone Number",fullWidth:!0,margin:"normal",error:!!i.phone,helperText:(r=i.phone)==null?void 0:r.message})}})}),e.jsx(m,{item:!0,xs:12,md:6,children:e.jsx(h,{name:"email",control:u,rules:{required:"Email is required",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Invalid email address"}},render:({field:a})=>{var r;return e.jsx(g,{...a,label:"Email",fullWidth:!0,margin:"normal",error:!!i.email,helperText:(r=i.email)==null?void 0:r.message})}})}),e.jsx(m,{item:!0,xs:12,md:6,children:e.jsx(h,{name:"phone",control:u,rules:{pattern:{value:/^[0-9]{10}$/,message:"Invalid phone number"}},render:({field:a})=>{var r;return e.jsx(g,{...a,label:"Phone Number",fullWidth:!0,margin:"normal",error:!!i.phone,helperText:(r=i.phone)==null?void 0:r.message})}})}),e.jsx(m,{item:!0,xs:12,md:6,children:e.jsx(h,{name:"organizationId",control:u,rules:{required:"Organization is required"},render:({field:a})=>{var r;return e.jsxs(H,{fullWidth:!0,margin:"normal",error:!!i.organizationId,children:[e.jsx(Y,{children:"Organization"}),e.jsx(G,{...a,label:"Organization",renderValue:c=>e.jsx(P,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:c.map(x=>{var S;return e.jsx(W,{component:"span",variant:"body2",children:(S=f==null?void 0:f.find(R=>R.id===x))==null?void 0:S.name},x)})}),children:f==null?void 0:f.map(c=>e.jsx(O,{value:c.id,children:c.name},c.id))}),e.jsx(Q,{children:(r=i.organizationId)==null?void 0:r.message})]})}})}),e.jsx(m,{item:!0,xs:12,md:6,children:e.jsx(h,{name:"qualifications",control:u,rules:{required:"Qualifications is required"},render:({field:a})=>{var r;return e.jsx(g,{...a,label:"Qualifications",fullWidth:!0,margin:"normal",error:!!i.qualifications,helperText:(r=i.qualifications)==null?void 0:r.message})}})}),e.jsx(m,{item:!0,xs:12,md:6,children:e.jsx(h,{name:"experience",control:u,rules:{required:"Experience is required"},render:({field:a})=>{var r;return e.jsx(g,{...a,label:"Experience",fullWidth:!0,margin:"normal",error:!!i.experience,helperText:(r=i.experience)==null?void 0:r.message})}})}),e.jsx(m,{item:!0,xs:12,md:6,children:e.jsx(h,{name:"officeHours",control:u,rules:{required:"Office Hours is required"},render:({field:a})=>{var r;return e.jsx(g,{...a,label:"Office Hours",fullWidth:!0,margin:"normal",error:!!i.officeHours,helperText:(r=i.officeHours)==null?void 0:r.message})}})}),e.jsx(m,{item:!0,xs:12,md:6,children:e.jsx(h,{name:"specialResponsibilities",control:u,rules:{required:"Special Responsibilities is required"},render:({field:a})=>{var r;return e.jsx(g,{...a,label:"Special Responsibilities",fullWidth:!0,margin:"normal",error:!!i.specialResponsibilities,helperText:(r=i.specialResponsibilities)==null?void 0:r.message})}})}),e.jsx(m,{item:!0,xs:12,children:e.jsxs(P,{sx:{display:"flex",justifyContent:"flex-end",gap:2,mt:2},children:[e.jsx(B,{variant:"outlined",color:"primary",onClick:()=>{y(w),n()},children:"Cancel"}),e.jsx(B,{type:"submit",variant:"contained",color:"primary",children:"Save"})]})})]})})};function Qe({route:s,routeData:t,canActivate:n}){console.log("routeData",t),console.log(n);const p=me(),l=he(),o=F(d=>d.teacher.data),f=pe(),{data:w,loading:u}=fe(s,f);console.log("data",w);const D=j.useMemo(()=>[{field:"name",headerName:"Teacher Name",flex:1,editable:!0,headerClassName:"theme--header"},{field:"phone",headerName:"Contact Phone",flex:1,editable:!0,headerClassName:"theme--header"},{field:"subjects",headerName:"Subjects",flex:1,editable:!0,headerClassName:"theme--header"},{field:"qualifications",headerName:"Qualifications",flex:1,editable:!0,headerClassName:"theme--header"},{field:"coursesTaught",headerName:"Courses Taught",flex:1,editable:!0,headerClassName:"theme--header"},{field:"createdAt",headerName:"Created At",flex:1,editable:!1,headerClassName:"theme--header"},{field:"updatedAt",headerName:"Updated At",flex:1,editable:!1,headerClassName:"theme--header"}],[]),[i,y]=j.useState({}),[N,C]=j.useState(""),[a,r]=j.useState(null),[c,x]=j.useState(!1),R=xe().pathname.includes("/teachers/profile"),U=j.useCallback(d=>{l(A.fetchTeachers(d))},[l]),{params:v,setParams:k}=be({page:1,limit:10,sortBy:void 0,sortOrder:void 0,searchTerm:void 0,filters:{}},U),L=d=>{k(d)},Z=()=>{r(null),C("Add Teacher"),z()},$=d=>{const T=o==null?void 0:o.teachers.find(_=>_._id===d);r(T||null),C("Edit Teacher"),z()},V=d=>{const T=o==null?void 0:o.teachers.find(_=>_._id===d);T&&p(je.TEACHER_PROFILE.replace(":id",T==null?void 0:T._id))},X=async d=>{l(A.deleteTeachers(d))},J=async d=>{l(a?A.updateTeachers({...d,_id:a._id}):A.createTeachers(d)),E()},K=()=>{l(A.fetchTeachers(v))},z=()=>x(!0),E=()=>x(!1),ee=(o==null?void 0:o.totalTeachers)||0;return e.jsx(P,{sx:{width:"100%",height:"100%"},children:R?e.jsx(ge,{}):e.jsxs(e.Fragment,{children:[e.jsx(ye,{columns:D,onAdd:Z,onDelete:X,onEdit:$,rows:(o==null?void 0:o.teachers)??[],rowModesModel:i,setRowModesModel:y,loading:u,reloadData:K,totalRows:ee,paginationModel:{page:v.page-1,pageSize:v.limit},onParamsChange:L,onView:V}),e.jsx(Ce,{open:c,onClose:E,title:N,children:e.jsx(De,{initialValues:a,onSubmit:J,onClose:E})})]})})}export{Qe as default};
//# sourceMappingURL=Teacher.page-CLUNOGyh.js.map
