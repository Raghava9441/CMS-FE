{"version":3,"file":"features.page-qpHJYq_E.js","sources":["../../src/hooks/useFeatureFlag.ts","../../src/components/featureControl/PermissionRow.tsx","../../src/components/featureControl/PermissionsTable.tsx","../../src/pages/features.page.tsx"],"sourcesContent":["// usePermissions.ts\nimport { useState, useCallback } from 'react';\nimport type { Permission } from '../types/Permission.types';\n\nexport function useFeatureFlag(initial: Permission[] = []) {\n    const [perms, setPerms] = useState<Permission[]>(initial);\n    const toggle = useCallback(\n        (index: number, key: keyof Pick<Permission, 'view' | 'edit' | 'delete'>) => {\n            setPerms((prev) =>\n                prev.map((p, i) =>\n                    i === index ? { ...p, [key]: !p[key] } : p\n                )\n            );\n        },\n        []\n    );\n\n    return { permissions: perms, toggle, setPermissions: setPerms };\n}","// PermissionRow.tsx\nimport React from 'react';\nimport {\n    TableRow,\n    TableCell,\n    Switch,\n    Typography,\n    Chip,\n} from '@mui/material';\nimport { Permission } from '@models/Permission.types';\n\ninterface Props {\n    index: number;\n    permission: Permission;\n    onToggle: (index: number, key: keyof Pick<Permission, 'view' | 'edit' | 'delete'>) => void;\n}\n\nconst PermissionRow: React.FC<Props> = ({ index, permission, onToggle }) => (\n    <TableRow>\n        <TableCell sx={{ padding: \"0px\", paddingX: \"10px\" }}>\n            <Typography variant=\"body1\" fontWeight=\"medium\">\n                {permission.name}\n            </Typography>\n        </TableCell>\n\n        {(['view', 'edit', 'delete'] as const).map((right) => (\n            <TableCell key={right} align=\"center\" sx={{ padding: \"0px\" }}>\n                <Switch\n                    checked={permission[right]}\n                    onChange={() => onToggle(index, right)}\n                    color={right === 'delete' ? 'error' : 'primary'}\n                    inputProps={{ 'aria-label': `${permission.name}-${right}` }}\n                />\n            </TableCell>\n        ))}\n    </TableRow>\n);\n\nexport default React.memo(PermissionRow);","// PermissionsTable.tsx\nimport React from 'react';\nimport {\n    Paper,\n    Table,\n    TableBody,\n    TableCell,\n    TableContainer,\n    TableHead,\n    TableRow,\n    Typography,\n    Box,\n    Chip,\n} from '@mui/material';\nimport { Permission } from '@models/Permission.types';\nimport PermissionRow from './PermissionRow';\n\ninterface Props {\n    permissions: Permission[];\n    onToggle: (index: number, key: keyof Pick<Permission, 'view' | 'edit' | 'delete'>) => void;\n}\n\nconst PermissionsTable: React.FC<Props> = ({ permissions, onToggle }) => (\n    <TableContainer component={Paper} elevation={3}>\n        <Table size=\"medium\">\n            <TableHead>\n                <TableRow>\n                    <TableCell sx={{ fontWeight: 600 }}>Feature</TableCell>\n                    {['View', 'Edit', 'Delete'].map((h) => (\n                        <TableCell key={h} align=\"center\" sx={{ fontWeight: 600 }}>\n                            <Chip label={h} size=\"small\" color={h === 'Delete' ? 'error' : 'primary'} />\n                        </TableCell>\n                    ))}\n                </TableRow>\n            </TableHead>\n            <TableBody>\n                {permissions.map((p, i) => (\n                    <PermissionRow key={p.name} index={i} permission={p} onToggle={onToggle} />\n                ))}\n            </TableBody>\n        </Table>\n    </TableContainer>\n);\n\nexport default PermissionsTable;","// AdminFeatureFlagsPage.tsx\nimport React, { useEffect } from 'react';\nimport { Container, Typography, Button, Box, Snackbar, Alert } from '@mui/material';\nimport SaveIcon from '@mui/icons-material/Save';\nimport { useFeatureFlag } from '@hooks/useFeatureFlag';\nimport { Permission } from '@models/Permission.types';\nimport PermissionsTable from '@components/featureControl/PermissionsTable';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { AppDispatch, RootState } from '@redux/store';\nimport { authActions } from '@redux/actions/auth.actions';\n\n\n\nexport default function AdminFeatureFlagsPage() {\n    const initialPermissions: Permission[] = useSelector((state: RootState) => state.auth.permissions);\n    console.log(\"initialPermissions\", initialPermissions)\n    const { _id } = useSelector((state: RootState) => state.auth.user);\n    const { permissions, toggle, setPermissions } = useFeatureFlag(initialPermissions);\n    const dispatch = useDispatch<AppDispatch>();\n    const [open, setOpen] = React.useState(false);\n\n    useEffect(() => {\n        setPermissions(initialPermissions);\n    }, [initialPermissions]);\n\n    const handleSave = () => {\n        // PUT /api/permissions  permissions\n        console.table(permissions);\n        console.log(_id)\n        dispatch(authActions.updatePermissions(permissions, _id));\n\n        setOpen(true);\n    };\n\n    return (\n        <Container maxWidth=\"md\" sx={{ overflowY: \"auto\", height: \"100%\" }}>\n            <Typography variant=\"h4\" gutterBottom>\n                Feature Permissions\n            </Typography>\n\n            <Box sx={{ mb: 2 }}>\n                <Button\n                    variant=\"contained\"\n                    startIcon={<SaveIcon />}\n                    onClick={handleSave}\n                    disabled={permissions.length === 0}\n                >\n                    Save changes\n                </Button>\n            </Box>\n\n            <PermissionsTable permissions={permissions} onToggle={toggle} />\n\n            <Snackbar\n                open={open}\n                autoHideDuration={3000}\n                onClose={() => setOpen(false)}\n                anchorOrigin={{ vertical: 'bottom', horizontal: 'center' }}\n            >\n                <Alert severity=\"success\" onClose={() => setOpen(false)}>\n                    Permissions saved!\n                </Alert>\n            </Snackbar>\n        </Container>\n    );\n}"],"names":["useFeatureFlag","initial","perms","setPerms","useState","toggle","useCallback","index","key","prev","p","i","PermissionRow","permission","onToggle","TableRow","jsx","TableCell","Typography","right","Switch","PermissionRow$1","React","PermissionsTable","permissions","TableContainer","Paper","jsxs","Table","TableHead","h","Chip","TableBody","AdminFeatureFlagsPage","initialPermissions","useSelector","state","_id","setPermissions","dispatch","useDispatch","open","setOpen","useEffect","handleSave","authActions","Container","Box","Button","SaveIcon","Snackbar","Alert"],"mappings":"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"}