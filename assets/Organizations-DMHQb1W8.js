const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/OrganizationForm-vMXyPadJ.js","assets/index-BYPGO0xu.js","assets/index-FJl57olM.css","assets/index.esm-DchJ7rh4.js","assets/Grid-BuBS1MM_.js","assets/TextField-BQekiIf9.js","assets/useFormControl-59XZlDUP.js","assets/InputBase-JqDfyn6V.js","assets/DatePicker-BBljA3yo.js","assets/InputAdornment-CRDLPjVz.js","assets/DialogContent-DHLXpHVO.js","assets/GenericModal-BO5sxVUC.js"])))=>i.map(i=>d[i]);
import{p as T,q as B,A as f,t as F,v as c,x as L,y as k,z as G,E as V,F as q,G as H,H as J,I as K,J as Q,r,h as O,j as l,B as U,K as x}from"./index-BYPGO0xu.js";import{u as W,R as X}from"./usePaginationParams-CARL4R2U.js";import"./Save-Cv6aO7K7.js";import"./reselect-GriJUApp.js";import"./InputBase-JqDfyn6V.js";import"./useFormControl-59XZlDUP.js";import"./TextField-BQekiIf9.js";import"./InputAdornment-CRDLPjVz.js";import"./Checkbox-M250Iqvq.js";import"./SwitchBase-EoaJ7mAe.js";import"./FormControlLabel-9ILp0wHF.js";import"./KeyboardArrowRight-CfBrqoEq.js";import"./TableCell-yS_KhqOx.js";import"./CircularProgress-B7BzOrJN.js";const Y={ADMIN:{organizations:{view:!0,create:!0,update:!0,delete:!0},teachers:{view:!0,create:!0,update:!0,delete:!0},students:{view:!0,create:!0,update:!0,delete:!0},parents:{view:!0,create:!0,update:!0,delete:!0},departments:{view:!0,create:!0,update:!0,delete:!0},classes:{view:!0,create:!0,update:!0,delete:!0},courses:{view:!0,create:!0,update:!0,delete:!0},events:{view:!0,create:!0,update:!0,delete:!0},assignments:{view:!0,create:!0,update:!0,delete:!0},exams:{view:!0,create:!0,update:!0,delete:!0},attendances:{view:!0,create:!0,update:!0,delete:!0},notifications:{view:!0,create:!0,update:!0,delete:!0},settings:{view:!0,create:!0,update:!0,delete:!0}},TEACHER:{organizations:{view:(e,a)=>e.organizationId===a._id,create:!1,update:!1,delete:!1},teachers:{view:(e,a)=>e.organizationId===a.organizationId,create:!1,update:(e,a)=>e.id===a.id,delete:!1},students:{view:(e,a)=>e.organizationId===a.organizationId,create:!1,update:!1,delete:!1},parents:{view:(e,a)=>e.organizationId===a.organizationId,create:!1,update:!1,delete:!1},departments:{view:(e,a)=>e.organizationId===a.organizationId,create:!1,update:!1,delete:!1},classes:{view:(e,a)=>e.organizationId===a.organizationId,create:!1,update:!1,delete:!1},courses:{view:(e,a)=>e.organizationId===a.organizationId,create:!1,update:!1,delete:!1},events:{view:(e,a)=>e.organizationId===a.organizationId,create:(e,a)=>e.organizationId===a.organizationId,update:(e,a)=>e.organizationId===a.organizationId,delete:!1},assignments:{view:(e,a)=>e.organizationId===a.organizationId,create:(e,a)=>e.organizationId===a.organizationId,update:(e,a)=>e.organizationId===a.organizationId,delete:(e,a)=>e.organizationId===a.organizationId},exams:{view:(e,a)=>e.organizationId===a.organizationId,create:(e,a)=>e.organizationId===a.organizationId,update:(e,a)=>e.organizationId===a.organizationId,delete:(e,a)=>e.organizationId===a.organizationId},attendances:{view:(e,a)=>e.organizationId===a.organizationId,create:(e,a)=>e.organizationId===a.organizationId,update:(e,a)=>e.organizationId===a.organizationId,delete:(e,a)=>e.organizationId===a.organizationId},notifications:{view:!0,create:!1,update:!1,delete:!1},settings:{view:!0,create:!0,update:!0,delete:!1}},STUDENT:{organizations:{view:(e,a)=>e.organizationId===a._id,create:!1,update:!1,delete:!1},teachers:{view:(e,a)=>e.organizationId===a._id,create:!1,update:!1,delete:!1},students:{view:(e,a)=>e.organizationId===a._id,create:!1,update:(e,a)=>e.organizationId===a._id,delete:!1},parents:{view:(e,a)=>e.organizationId===a._id,create:!1,update:!1,delete:!1},departments:{view:(e,a)=>e.organizationId===a._id,create:!1,update:!1,delete:!1},classes:{view:(e,a)=>e.organizationId===a._id,create:!1,update:!1,delete:!1},courses:{view:(e,a)=>e.organizationId===a._id,create:!1,update:!1,delete:!1},events:{view:(e,a)=>e.organizationId===a._id,create:!1,update:!1,delete:!1},assignments:{view:(e,a)=>e.organizationId===a._id,create:!1,update:!1,delete:!1},exams:{view:(e,a)=>e.organizationId===a._id,create:!1,update:!1,delete:!1},attendances:{view:(e,a)=>e.organizationId===a._id,create:!1,update:!1,delete:!1},notifications:{view:(e,a)=>e.organizationId===a._id,create:!1,update:!1,delete:!1},settings:{view:(e,a)=>e.organizationId===a._id,create:!1,update:!1,delete:!1}},PARENT:{organizations:{view:(e,a)=>e.organizationId===a._id,create:!1,update:!1,delete:!1},teachers:{view:(e,a)=>e.organizationId===a._id,create:!1,update:!1,delete:!1},students:{view:(e,a)=>e.organizationId===a._id,create:!1,update:!1,delete:!1},parents:{view:(e,a)=>e.organizationId===a._id,create:!1,update:!1,delete:!1},departments:{view:(e,a)=>e.organizationId===a._id,create:!1,update:!1,delete:!1},classes:{view:(e,a)=>e.organizationId===a._id,create:!1,update:!1,delete:!1},courses:{view:(e,a)=>e.organizationId===a._id,create:!1,update:!1,delete:!1},events:{view:(e,a)=>e.organizationId===a._id,create:!1,update:!1,delete:!1},assignments:{view:(e,a)=>e.organizationId===a._id,create:!1,update:!1,delete:!1},exams:{view:(e,a)=>e.organizationId===a._id,create:!1,update:!1,delete:!1},attendances:{view:(e,a)=>e.organizationId===a._id,create:!1,update:!1,delete:!1},notifications:{view:(e,a)=>e.organizationId===a._id,create:!1,update:!1,delete:!1},settings:{view:(e,a)=>e.organizationId===a._id,create:!1,update:!1,delete:!1}},ORGADMIN:{organizations:{view:(e,a)=>e.organizationId===a._id,create:!1,update:!1,delete:!1},teachers:{view:(e,a)=>e.organizationId===a._id,create:!1,update:!1,delete:!1},students:{view:(e,a)=>e.organizationId===a._id,create:!1,update:!1,delete:!1},parents:{view:(e,a)=>e.organizationId===a._id,create:!1,update:!1,delete:!1},departments:{view:(e,a)=>e.organizationId===a._id,create:!1,update:!1,delete:!1},classes:{view:(e,a)=>e.organizationId===a._id,create:!1,update:!1,delete:!1},courses:{view:(e,a)=>e.organizationId===a._id,create:!1,update:!1,delete:!1},events:{view:(e,a)=>e.organizationId===a._id,create:!1,update:!1,delete:!1},assignments:{view:(e,a)=>e.organizationId===a._id,create:!1,update:!1,delete:!1},exams:{view:(e,a)=>e.organizationId===a._id,create:!1,update:!1,delete:!1},attendances:{view:(e,a)=>e.organizationId===a._id,create:!1,update:!1,delete:!1},notifications:{view:(e,a)=>e.organizationId===a._id,create:!1,update:!1,delete:!1},settings:{view:(e,a)=>e.organizationId===a._id,create:!1,update:!1,delete:!1}}};function Z(e,a,t,o){var g;const s=e.role,d=(g=Y[s][a])==null?void 0:g[t];return d==null?!1:typeof d=="boolean"?d:o!=null&&d(e,o)}const $=e=>async a=>{var t,o;try{const s=T(e);a(B());const d=await f.getOrganizations(s);console.log(d),a(F(d.data.data))}catch(s){c.error(((o=(t=s.response)==null?void 0:t.data)==null?void 0:o.data)||"Failed to fetch organizations",{autoClose:3e3})}},ee=e=>async a=>{try{a(J());const t=await f.getOrganizationById(e);a(K(t.data.data))}catch(t){c.error(t.response.data.data||"Failed to fetch organization",{autoClose:3e3})}},ae=e=>async a=>{try{a(q());const t=await f.createOrganization(e);return a(H(t.data.data)),t.data}catch(t){c.error(t.response.data.data||"Failed to fetch organization",{autoClose:3e3})}},te=e=>async a=>{try{a(G());const t=await f.updateOrganization(e,e.id);return a(V(t.data.data)),t.data}catch(t){c.error(t.response.data.data||"Failed to fetch organization",{autoClose:3e3})}},ie=e=>async a=>{var t,o;try{a(L());const s=await f.deleteOrganization(e);a(k(e)),c.info("Organization deleted successfully",{autoClose:3e3})}catch(s){c.error(((o=(t=s==null?void 0:s.response)==null?void 0:t.data)==null?void 0:o.data)||"Failed to fetch organization",{autoClose:3e3})}},u={fetchOrganizations:$,fetchOrganizationById:ee,createOrganization:ae,updateOrganization:te,deleteOrganization:ie},se=r.lazy(()=>x(()=>import("./OrganizationForm-vMXyPadJ.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))),ne=r.lazy(()=>x(()=>import("./GenericModal-BO5sxVUC.js"),__vite__mapDeps([11,1,2,10])));function he(){const e=Q(),a=r.useMemo(()=>[{field:"name",headerName:"Name",flex:1,editable:!0,headerClassName:"theme--header"},{field:"category",headerName:"Category",flex:1,editable:!0,headerClassName:"theme--header"},{field:"number",headerName:"Number",flex:1,editable:!0,headerClassName:"theme--header"},{field:"contactEmail",headerName:"Contact Email",flex:1,editable:!0,headerClassName:"theme--header"},{field:"contactPhone",headerName:"Contact Phone",flex:1,editable:!0,headerClassName:"theme--header"},{field:"establishedDate",headerName:"Established Date",flex:1,editable:!0,headerClassName:"theme--header"},{field:"description",headerName:"Description",flex:1,editable:!0,headerClassName:"theme--header"}],[]),[t,o]=r.useState({}),[s,d]=r.useState(!1),[g,m]=r.useState(void 0),[z,w]=r.useState(null),{data:n,loading:y}=O(i=>i.organization),p=O(i=>i.auth.user),C=r.useMemo(()=>!p||!(n!=null&&n.organizations)?[]:n.organizations.filter(i=>Z(p,"organizations","view",i)),[p,n]),S=r.useCallback(i=>{e(u.fetchOrganizations(i))},[e]),{params:I,setParams:N}=W({page:1,limit:10,sortBy:void 0,sortOrder:void 0,searchTerm:void 0,filters:{}},S),b=i=>{N(i)},E=()=>{w(null),m("Add Organization"),h()},D=i=>{const _=n==null?void 0:n.organizations.find(j=>j._id===i);console.log("selectedOrganization",_),w(_),m("Edit Organization"),h()},P=async i=>{e(u.deleteOrganization(i))},R=async i=>{e(z?u.updateOrganization({id:z._id,...i}):u.createOrganization(i)),v()},A=()=>{e(u.fetchOrganizations(I))},h=()=>d(!0),v=()=>d(!1),M=(n==null?void 0:n.totalOrganizations)||0;return l.jsxs(U,{sx:{width:"100%",height:"100%",minWidth:0,overflow:"hidden"},children:[l.jsx(X,{columns:a,onAdd:E,onDelete:P,onEdit:D,rows:C??[],rowModesModel:t,setRowModesModel:o,loading:y,reloadData:A,totalRows:M,paginationModel:{page:I.page-1,pageSize:I.limit},onParamsChange:i=>b(i)}),s&&l.jsx(r.Suspense,{fallback:l.jsx("div",{children:"Loading modal..."}),children:l.jsx(ne,{open:s,onClose:v,title:g,children:l.jsx(r.Suspense,{fallback:l.jsx("div",{children:"Loading form..."}),children:l.jsx(se,{initialValues:z,onSubmit:R,onClose:v})})})})]})}export{he as default};
//# sourceMappingURL=Organizations-DMHQb1W8.js.map
