import{G as Y,H as A,I as G,J as C,c as b,K as P,L as Q,N as U,O as Z,P as $,Q as k,R as L,S as J,o as w,r as g,d as R,j as e,M as v,T as _,B as E,a as z,n as K}from"./index-CjFY2UwW.js";import{u as X,C as u,R as V,G as ee}from"./ReusableDataGrid-CTE2uJu8.js";import{G as c}from"./Grid-RayMH9Fy.js";import{F,I as M,S as W,a as H,T as j}from"./TextField-CIsl_p1p.js";import"./useId-dEPY52Ve.js";import"./Tooltip-J9mTvUct.js";import"./Checkbox-F6YpTJ39.js";import"./FormControlLabel-Zk4Xj0xD.js";import"./KeyboardArrowRight-COf2szsc.js";import"./CircularProgress-DGyfmA0F.js";import"./Skeleton-BcuW3HOB.js";try{let r=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},s=new r.Error().stack;s&&(r._sentryDebugIds=r._sentryDebugIds||{},r._sentryDebugIds[s]="5636055a-8c55-42f3-97ae-82967e6c3b7f",r._sentryDebugIdIdentifier="sentry-dbid-5636055a-8c55-42f3-97ae-82967e6c3b7f")}catch{}const re=()=>async r=>{var s,n;try{r(Y());const h=await A.getTeachers();r(G(h.data.data))}catch(h){r(C()),b.error(((n=(s=h.response)==null?void 0:s.data)==null?void 0:n.data)||"Failed to fetch organizations",{autoClose:3e3})}},ae=r=>async s=>{try{s(L());const n=await A.getTeacherById(r);s(J(n.data.data))}catch(n){s(C()),b.error(n.response.data.data||"Failed to fetch organization",{autoClose:3e3})}},te=r=>async s=>{try{s($());const n=await A.createTeacher(r);return s(k(n.data.data)),n.data}catch(n){s(C()),b.error(n.response.data.data||"Failed to fetch organization",{autoClose:3e3})}},se=r=>async s=>{try{if(s(U()),r._id){const n=await A.updateTeacher(r,r._id);return s(Z(n.data.data)),n.data}else throw new Error("Teacher ID is required for update")}catch(n){s(C()),n instanceof Error&&b.error(n.message||"Failed to fetch organization",{autoClose:3e3})}},ne=r=>async s=>{try{s(P());const n=await A.deleteTeacher(r);s(Q(r)),b.info(n.message||"Organization deleted successfully",{autoClose:3e3})}catch(n){s(C()),console.log(n),b.error(n.response.data.data||"Failed to fetch organization",{autoClose:3e3})}},I={fetchTeachers:re,fetchTeacherById:ae,createTeachers:te,updateTeachers:se,deleteTeachers:ne},ie=({initialValues:r,onSubmit:s,onClose:n})=>{var q;const{data:h}=w(a=>a.user),{data:y}=w(a=>a.organization),f=(q=h==null?void 0:h.users)==null?void 0:q.filter(a=>a.role==="TEACHER"),m=y==null?void 0:y.organizations,T={_id:"",userId:"",name:"",phone:"",email:"",organizationId:"",organizations:[],departments:[],subjects:[],qualifications:"",experience:0,officeHours:"",coursesTaught:[],performanceReviews:[],specialResponsibilities:"",createdAt:null,updatedAt:null},{control:l,handleSubmit:N,formState:{errors:i},reset:S}=X({defaultValues:T});g.useEffect(()=>{r&&S({...r,createdAt:r.createdAt?R(r.createdAt):null,updatedAt:r.updatedAt?R(r.updatedAt):null})},[r,S]);const D=a=>{const t={...a,createdAt:a.createdAt?a.createdAt.format("YYYY-MM-DD"):null,updatedAt:a.updatedAt?a.updatedAt.format("YYYY-MM-DD"):null};s(t)};return e.jsx("form",{onSubmit:N(D),children:e.jsxs(c,{container:!0,spacing:2,children:[e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(u,{name:"userId",control:l,rules:{required:"User ID is required"},render:({field:a})=>{var t;return e.jsxs(F,{fullWidth:!0,margin:"normal",error:!!i.userId,children:[e.jsx(M,{children:"User ID"}),e.jsx(W,{...a,label:"User ID",renderValue:d=>{var p;return e.jsx(_,{variant:"body2",children:(p=f==null?void 0:f.find(x=>x._id===d))==null?void 0:p.username})},children:f==null?void 0:f.map(d=>e.jsx(v,{value:d._id,children:d.username},d._id))}),e.jsx(H,{children:(t=i.userId)==null?void 0:t.message})]})}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(u,{name:"name",control:l,rules:{required:"Name is required"},render:({field:a})=>{var t;return e.jsx(j,{...a,label:"Name",fullWidth:!0,margin:"normal",error:!!i.name,helperText:(t=i.name)==null?void 0:t.message})}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(u,{name:"phone",control:l,rules:{required:"Phone is required",pattern:{value:/^[0-9]{10}$/,message:"Invalid phone number"}},render:({field:a})=>{var t;return e.jsx(j,{...a,label:"Phone Number",fullWidth:!0,margin:"normal",error:!!i.phone,helperText:(t=i.phone)==null?void 0:t.message})}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(u,{name:"email",control:l,rules:{required:"Email is required",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Invalid email address"}},render:({field:a})=>{var t;return e.jsx(j,{...a,label:"Email",fullWidth:!0,margin:"normal",error:!!i.email,helperText:(t=i.email)==null?void 0:t.message})}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(u,{name:"phone",control:l,rules:{pattern:{value:/^[0-9]{10}$/,message:"Invalid phone number"}},render:({field:a})=>{var t;return e.jsx(j,{...a,label:"Phone Number",fullWidth:!0,margin:"normal",error:!!i.phone,helperText:(t=i.phone)==null?void 0:t.message})}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(u,{name:"organizationId",control:l,rules:{required:"Organization is required"},render:({field:a})=>{var t;return e.jsxs(F,{fullWidth:!0,margin:"normal",error:!!i.organizationId,children:[e.jsx(M,{children:"Organization"}),e.jsx(W,{...a,label:"Organization",renderValue:d=>e.jsx(E,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:d.map(p=>{var x;return e.jsx(_,{component:"span",variant:"body2",children:(x=m==null?void 0:m.find(o=>o.id===p))==null?void 0:x.name},p)})}),children:m==null?void 0:m.map(d=>e.jsx(v,{value:d.id,children:d.name},d.id))}),e.jsx(H,{children:(t=i.organizationId)==null?void 0:t.message})]})}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(u,{name:"qualifications",control:l,rules:{required:"Qualifications is required"},render:({field:a})=>{var t;return e.jsx(j,{...a,label:"Qualifications",fullWidth:!0,margin:"normal",error:!!i.qualifications,helperText:(t=i.qualifications)==null?void 0:t.message})}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(u,{name:"experience",control:l,rules:{required:"Experience is required"},render:({field:a})=>{var t;return e.jsx(j,{...a,label:"Experience",fullWidth:!0,margin:"normal",error:!!i.experience,helperText:(t=i.experience)==null?void 0:t.message})}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(u,{name:"officeHours",control:l,rules:{required:"Office Hours is required"},render:({field:a})=>{var t;return e.jsx(j,{...a,label:"Office Hours",fullWidth:!0,margin:"normal",error:!!i.officeHours,helperText:(t=i.officeHours)==null?void 0:t.message})}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(u,{name:"specialResponsibilities",control:l,rules:{required:"Special Responsibilities is required"},render:({field:a})=>{var t;return e.jsx(j,{...a,label:"Special Responsibilities",fullWidth:!0,margin:"normal",error:!!i.specialResponsibilities,helperText:(t=i.specialResponsibilities)==null?void 0:t.message})}})}),e.jsx(c,{item:!0,xs:12,children:e.jsxs(E,{sx:{display:"flex",justifyContent:"flex-end",gap:2,mt:2},children:[e.jsx(z,{variant:"outlined",color:"primary",onClick:()=>{S(T),n()},children:"Cancel"}),e.jsx(z,{type:"submit",variant:"contained",color:"primary",children:"Save"})]})})]})})};function ge(){const r=K(),s=w(o=>o.teacher.data),n=g.useMemo(()=>[{field:"name",headerName:"Teacher Name",flex:1,editable:!0,headerClassName:"theme--header"},{field:"phone",headerName:"Contact Phone",flex:1,editable:!0,headerClassName:"theme--header"},{field:"subjects",headerName:"Subjects",flex:1,editable:!0,headerClassName:"theme--header"},{field:"qualifications",headerName:"Qualifications",flex:1,editable:!0,headerClassName:"theme--header"},{field:"coursesTaught",headerName:"Courses Taught",flex:1,editable:!0,headerClassName:"theme--header"},{field:"createdAt",headerName:"Created At",flex:1,editable:!1,headerClassName:"theme--header"},{field:"updatedAt",headerName:"Updated At",flex:1,editable:!1,headerClassName:"theme--header"}],[]),[h,y]=g.useState({}),[f,m]=g.useState(""),[T,l]=g.useState(null),[N,i]=g.useState(!1),{loading:S}=w(o=>o.teacher);g.useEffect(()=>{r(I.fetchTeachers())},[r]);const D=()=>{l(null),m("Add Teacher"),p()},q=o=>{const O=s==null?void 0:s.teachers.find(B=>B._id===o);l(O||null),m("Edit Teacher"),p()},a=async o=>{r(I.deleteTeachers(o))},t=async o=>{r(T?I.updateTeachers({...o,_id:T._id}):I.createTeachers(o)),x()},d=()=>{r(I.fetchTeachers())},p=()=>i(!0),x=()=>i(!1);return e.jsxs(E,{sx:{width:"100%",height:"100%"},children:[e.jsx(V,{columns:n,onAdd:D,onDelete:a,onEdit:q,rows:(s==null?void 0:s.teachers)??[],rowModesModel:h,setRowModesModel:y,loading:S,reloadData:d}),e.jsx(ee,{open:N,onClose:x,title:f,children:e.jsx(ie,{initialValues:T,onSubmit:t,onClose:x})})]})}export{ge as default};
//# sourceMappingURL=Teacher.page-4fBLvNTe.js.map
