import{h as B,r as f,L as O,j as e,M as g,B as F,T as z,N as k,J as _,O as y}from"./index-B6Q5p1mB.js";import L from"./GenericModal-lxnmMOUT.js";import{u as G,C as i}from"./index.esm-BWg4JeyN.js";import{G as l}from"./Grid-BZIlOCxN.js";import{T as p,F as S,I as T,S as C,a as D}from"./TextField-CqXArht2.js";import{D as $}from"./DatePicker-kGeQ5F1d.js";import{F as Z}from"./FormControlLabel-Dlj7SghN.js";import{S as H}from"./Switch-BSMMeshO.js";import{u as J,R as K}from"./usePaginationParams-BufhDkfw.js";import"./DialogContent-ITkyIvN5.js";import"./useFormControl-BFweTqSu.js";import"./InputBase-DvqLZ0SM.js";import"./InputAdornment-BOLYg3Uk.js";import"./SwitchBase-BDBXzfmE.js";import"./Save-BBcKUFz4.js";import"./reselect-C7xKFEgn.js";import"./Checkbox-BMGwJpsF.js";import"./KeyboardArrowRight-B3CRtIMa.js";import"./TableCell-CnYRmD86.js";import"./CircularProgress-BiVxsZzW.js";try{let t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},b=new t.Error().stack;b&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[b]="b5c62de5-aa15-486d-ba2d-1ab03a01bb9a",t._sentryDebugIdIdentifier="sentry-dbid-b5c62de5-aa15-486d-ba2d-1ab03a01bb9a")}catch{}const Q=({initialValues:t,onSubmit:b,onClose:U})=>{var d;const{data:v}=B(r=>r.organization),h=(d=v==null?void 0:v.organizations)==null?void 0:d.map(r=>({id:r._id,name:r.name})),j={_id:"",organizations:h||[],organizationId:h?h[0].id:"",username:"",email:"",fullname:"",avatar:"",coverImage:"",age:"",role:"STUDENT",gender:"male",phone:"",address:{street:"",city:"",state:"",zip:"",country:""},status:"active",dateOfBirth:null,biography:"",permissions:[],socialLinks:{facebook:"",twitter:"",linkedin:"",instagram:""},preferences:{notifications:!0,language:"en",theme:"light",timezone:"Asia/Kolkata",currency:"INR",dateFormat:"DD/MM/YYYY"},createdAt:null,updatedAt:null},{control:n,handleSubmit:N,formState:{errors:a},reset:A}=G({defaultValues:j});f.useEffect(()=>{t&&A({...t,dateOfBirth:t.dateOfBirth?O(t.dateOfBirth):null,createdAt:t.createdAt?O(t.createdAt):null,updatedAt:t.updatedAt?O(t.updatedAt):null})},[t,A]);const I=r=>{const s={...r,dateOfBirth:r.dateOfBirth?r.dateOfBirth.format("YYYY-MM-DD"):null,createdAt:r.createdAt?r.createdAt.format("YYYY-MM-DD"):null,updatedAt:r.updatedAt?r.updatedAt.format("YYYY-MM-DD"):null,organizations:r.organizations,organizationId:r.organizations?r.organizations[0].id:""};b(s)};return e.jsx("form",{onSubmit:N(I),children:e.jsxs(l,{container:!0,spacing:2,children:[e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(i,{name:"username",control:n,rules:{required:"Username is required"},render:({field:r})=>{var s;return e.jsx(p,{...r,label:"Username",size:"small",fullWidth:!0,margin:"normal",error:!!a.username,helperText:(s=a.username)==null?void 0:s.message})}})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(i,{name:"fullname",control:n,rules:{required:"Full name is required"},render:({field:r})=>{var s;return e.jsx(p,{...r,label:"Full Name",size:"small",fullWidth:!0,margin:"normal",error:!!a.fullname,helperText:(s=a.fullname)==null?void 0:s.message})}})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(i,{name:"organizations",control:n,rules:{required:"At least one organization is required"},render:({field:r})=>{var s;return e.jsxs(S,{fullWidth:!0,margin:"normal",error:!!a.organizations,children:[e.jsx(T,{children:"Organizations"}),e.jsx(C,{...r,multiple:!0,label:"Organizations",size:"small",renderValue:o=>e.jsx(F,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:o.map(u=>{var c;return e.jsx(z,{component:"span",variant:"body2",children:(c=h==null?void 0:h.find(x=>x.id===u))==null?void 0:c.name},u)})}),children:h==null?void 0:h.map(o=>e.jsx(g,{value:o.id,children:o.name},o.id))}),e.jsx(D,{children:(s=a.organizations)==null?void 0:s.message})]})}})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(i,{name:"email",size:"small",control:n,rules:{required:"Email is required",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Invalid email address"}},render:({field:r})=>{var s;return e.jsx(p,{...r,label:"Email",size:"small",fullWidth:!0,margin:"normal",error:!!a.email,helperText:(s=a.email)==null?void 0:s.message})}})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(i,{name:"age",control:n,rules:{required:"Age is required",pattern:{value:/^[0-9]+$/,message:"Age must be a number"}},render:({field:r})=>{var s;return e.jsx(p,{...r,label:"Age",size:"small",fullWidth:!0,margin:"normal",error:!!a.age,helperText:(s=a.age)==null?void 0:s.message})}})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(i,{name:"role",control:n,rules:{required:"Role is required"},render:({field:r})=>{var s;return e.jsxs(S,{fullWidth:!0,margin:"normal",error:!!a.role,size:"small",children:[e.jsx(T,{children:"Role"}),e.jsxs(C,{...r,label:"Role",children:[e.jsx(g,{value:"ADMIN",children:"Admin"}),e.jsx(g,{value:"TEACHER",children:"Teacher"}),e.jsx(g,{value:"STUDENT",children:"Student"}),e.jsx(g,{value:"PARENT",children:"Parent"})]}),e.jsx(D,{children:(s=a.role)==null?void 0:s.message})]})}})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(i,{name:"gender",control:n,rules:{required:"Gender is required"},render:({field:r})=>{var s;return e.jsxs(S,{fullWidth:!0,margin:"normal",error:!!a.gender,size:"small",children:[e.jsx(T,{children:"Gender"}),e.jsxs(C,{...r,label:"Gender",children:[e.jsx(g,{value:"male",children:"Male"}),e.jsx(g,{value:"female",children:"Female"}),e.jsx(g,{value:"other",children:"Other"})]}),e.jsx(D,{children:(s=a.gender)==null?void 0:s.message})]})}})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(i,{name:"phone",control:n,rules:{pattern:{value:/^[0-9]{10}$/,message:"Invalid phone number"}},render:({field:r})=>{var s;return e.jsx(p,{...r,label:"Phone",size:"small",fullWidth:!0,margin:"normal",error:!!a.phone,helperText:(s=a.phone)==null?void 0:s.message})}})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(i,{name:"avatar",control:n,render:({field:r})=>{var s;return e.jsx(p,{...r,label:"Avatar URL",size:"small",fullWidth:!0,margin:"normal",error:!!a.avatar,helperText:(s=a.avatar)==null?void 0:s.message})}})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(i,{name:"coverImage",control:n,render:({field:r})=>{var s;return e.jsx(p,{...r,label:"Cover Image URL",size:"small",fullWidth:!0,margin:"normal",error:!!a.coverImage,helperText:(s=a.coverImage)==null?void 0:s.message})}})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(i,{name:"dateOfBirth",control:n,render:({field:r})=>{var s;return e.jsx($,{label:"Date of Birth",value:r.value,onChange:o=>r.onChange(o),slotProps:{textField:{size:"small",fullWidth:!0,error:!!a.dateOfBirth,helperText:(s=a.dateOfBirth)==null?void 0:s.message}}})}})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(i,{name:"status",control:n,render:({field:r})=>{var s;return e.jsxs(S,{fullWidth:!0,margin:"normal",error:!!a.status,size:"small",children:[e.jsx(T,{children:"Status"}),e.jsxs(C,{...r,label:"Status",children:[e.jsx(g,{value:"active",children:"Active"}),e.jsx(g,{value:"inactive",children:"Inactive"})]}),e.jsx(D,{children:(s=a.status)==null?void 0:s.message})]})}})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(i,{name:"biography",control:n,render:({field:r})=>{var s;return e.jsx(p,{...r,label:"Biography",fullWidth:!0,multiline:!0,rows:4,margin:"normal",error:!!a.biography,helperText:(s=a.biography)==null?void 0:s.message})}})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(z,{variant:"h6",children:"Address"})}),["street","city","state","zip","country"].map(r=>e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(i,{name:`address.${r}`,control:n,render:({field:{onChange:s,value:o}})=>{var u,c,x;return e.jsx(p,{label:r.charAt(0).toUpperCase()+r.slice(1),fullWidth:!0,margin:"normal",size:"small",value:o,onChange:s,error:!!((u=a.address)!=null&&u[r]),helperText:(x=(c=a.address)==null?void 0:c[r])==null?void 0:x.message})}})},r)),e.jsx(l,{item:!0,xs:12,children:e.jsx(z,{variant:"h6",children:"Social Links"})}),["facebook","twitter","linkedin","instagram"].map(r=>e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(i,{name:`socialLinks.${r}`,control:n,render:({field:{onChange:s,value:o}})=>{var u,c,x;return e.jsx(p,{label:r.charAt(0).toUpperCase()+r.slice(1),fullWidth:!0,margin:"normal",size:"small",value:o,onChange:s,error:!!((u=a.socialLinks)!=null&&u[r]),helperText:(x=(c=a.socialLinks)==null?void 0:c[r])==null?void 0:x.message})}})},r)),e.jsx(l,{item:!0,xs:12,children:e.jsx(z,{variant:"h6",children:"Preferences"})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(i,{name:"preferences.notifications",control:n,render:({field:{onChange:r,value:s}})=>e.jsx(Z,{control:e.jsx(H,{checked:s,onChange:r,color:"primary"}),label:"Notifications"})})}),["language","theme","timezone","currency","dateFormat"].map(r=>e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(i,{name:`preferences.${r}`,control:n,render:({field:{onChange:s,value:o}})=>{var u,c,x;return e.jsx(p,{label:r.charAt(0).toUpperCase()+r.slice(1),fullWidth:!0,margin:"normal",size:"small",value:o,onChange:s,error:!!((u=a.preferences)!=null&&u[r]),helperText:(x=(c=a.preferences)==null?void 0:c[r])==null?void 0:x.message})}})},r)),e.jsx(l,{item:!0,xs:12,children:e.jsxs(F,{sx:{display:"flex",justifyContent:"flex-end",gap:2,mt:2},children:[e.jsx(k,{variant:"outlined",color:"primary",onClick:()=>{A(j),U()},children:"Cancel"}),e.jsx(k,{type:"submit",variant:"contained",color:"primary",children:"Save"})]})})]})})};function fe(){const t=_(),[b,U]=f.useState({}),[v,h]=f.useState(""),[j,n]=f.useState(null),[N,a]=f.useState(!1),A=f.useMemo(()=>[{field:"username",headerName:"Username",flex:1,editable:!0,headerClassName:"theme--header"},{field:"email",headerName:"Email",flex:1,editable:!0,headerClassName:"theme--header"},{field:"fullname",headerName:"Full Name",flex:1,editable:!0,headerClassName:"theme--header"},{field:"role",headerName:"Role",flex:1,editable:!0,headerClassName:"theme--header"},{field:"gender",headerName:"Gender",flex:1,editable:!0,headerClassName:"theme--header"},{field:"status",headerName:"Status",flex:1,editable:!0,headerClassName:"theme--header"}],[]),{loading:I,data:d}=B(m=>m.user),r=f.useCallback(m=>{t(y.fetchUsers(m))},[t]),{params:s,setParams:o}=J({page:1,limit:10,sortBy:void 0,sortOrder:void 0,searchTerm:void 0,filters:{}},r),u=m=>{o(m),console.log(m)},c=()=>{n(null),h("Add User"),W()},x=m=>{const w=d==null?void 0:d.users.find(P=>P._id===m);n(w||null),h("Edit User"),W()},Y=m=>{t(y.deleteUser(m))},E=async m=>{j!=null&&j._id?t(y.updateUser({...m,_id:j._id})):t(y.createUser(m)),M()},R=()=>{t(y.fetchUsers(s))},W=()=>a(!0),M=()=>a(!1),q=(d==null?void 0:d.totalUsers)||0;return d!=null&&d.users,e.jsxs(F,{sx:{height:"100%"},children:[e.jsx(K,{columns:A,onAdd:c,onEdit:x,onDelete:Y,rows:(d==null?void 0:d.users)||[],rowModesModel:b,setRowModesModel:U,loading:I,reloadData:R,totalRows:q,paginationModel:{page:s.page-1,pageSize:s.limit},onParamsChange:m=>u(m),enableSearch:!0,enableFilters:!0,enableSorting:!0,searchPlaceholder:"Search users...",pageSizeOptions:[5,10,25,50,100]}),e.jsx(L,{open:N,onClose:M,title:v,children:e.jsx(Q,{initialValues:j,onSubmit:E,onClose:M})})]})}export{fe as default};
//# sourceMappingURL=Users.page-CxIjOLAK.js.map
