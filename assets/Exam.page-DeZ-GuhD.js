const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ExamForm-BRVzmQJp.js","assets/index-B_cqZJjc.js","assets/index-ByN57GGS.css","assets/index.esm-Dp1cijLg.js","assets/Grid-CvVXWlm9.js","assets/TextField-ClGj9etd.js","assets/InputBase-DZRnDgal.js","assets/isHostComponent-DI6Zuu5e.js","assets/Modal-Du6OQ6mG.js","assets/Menu-e_9qz1_v.js","assets/List-BPqtGCWZ.js","assets/MenuItem-B4_Mu9KU.js","assets/listItemTextClasses-CDVTXtLO.js","assets/DatePicker-DnW__EfO.js","assets/useMediaQuery-B7d5C5rB.js","assets/InputAdornment-DUdQhZFs.js","assets/DialogContent-YmIWMa_G.js","assets/ListItem-BODdqm9C.js","assets/GenericModal-DRmTlWuR.js","assets/Slide-Ccc21anO.js"])))=>i.map(i=>d[i]);
import{p as I,bE as k,bF as c,bG as O,h as i,bH as L,bI as z,bJ as G,bK as V,bL as q,bM as H,bN as J,bO as K,b as Q,r as d,u as S,j as l,B as W,_ as C}from"./index-B_cqZJjc.js";import{h as U}from"./auth-CvwlPVjT.js";import{u as X,R as Y}from"./usePaginationParams-CJmsz9yU.js";import"./Edit-kS102nZz.js";import"./Save-gzNur6WS.js";import"./Search-DHSeIu6K.js";import"./isHostComponent-DI6Zuu5e.js";import"./KeyboardArrowRight-D4fgx2v_.js";import"./InputBase-DZRnDgal.js";import"./Modal-Du6OQ6mG.js";import"./MenuItem-B4_Mu9KU.js";import"./List-BPqtGCWZ.js";import"./listItemTextClasses-CDVTXtLO.js";import"./Toolbar-CGqPdFQv.js";import"./TextField-ClGj9etd.js";import"./Menu-e_9qz1_v.js";import"./Visibility-C7dMWSp3.js";import"./reselect-chQN1zS_.js";import"./ListItemText-CtyCBBH7.js";import"./InputAdornment-DUdQhZFs.js";import"./Checkbox-2PS_Y14Y.js";import"./SwitchBase-TI0bsxNd.js";import"./FormControlLabel-BAAYPI9o.js";import"./LinearProgress-CV2szxl6.js";import"./CircularProgress-0PMFYM1C.js";const Z=a=>async s=>{var e,m;try{const r=I(a);s(k());const h=await c.getExams(r);s(O(h.data.data))}catch(r){i.error(((m=(e=r.response)==null?void 0:e.data)==null?void 0:m.data)||"Failed to fetch exams",{autoClose:3e3})}},$=a=>async s=>{try{s(J());const e=await c.getExamById(a);s(K(e.data.data))}catch(e){i.error(e.response.data.data||"Failed to fetch exam",{autoClose:3e3})}},ee=a=>async s=>{try{s(q());const e=await c.createExam(a);return s(H(e.data.data)),e.data}catch(e){i.error(e.response.data.data||"Failed to create exam",{autoClose:3e3})}},ae=a=>async s=>{try{s(G());const e=await c.updateExam(a,a._id);return s(V(e.data.data)),e.data}catch(e){i.error(e.response.data.data||"Failed to update exam",{autoClose:3e3})}},te=a=>async s=>{var e,m;try{s(L());const r=await c.deleteExam(a);s(z(a)),i.info("Exam deleted successfully",{autoClose:3e3})}catch(r){i.error(((m=(e=r==null?void 0:r.response)==null?void 0:e.data)==null?void 0:m.data)||"Failed to delete exam",{autoClose:3e3})}},n={fetchExams:Z,fetchExamById:$,createExam:ee,updateExam:ae,deleteExam:te},se=d.lazy(()=>C(()=>import("./ExamForm-BRVzmQJp.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]))),re=d.lazy(()=>C(()=>import("./GenericModal-DRmTlWuR.js"),__vite__mapDeps([18,1,2,16,8,19])));function je(){const a=Q(),s=d.useMemo(()=>[{field:"name",headerName:"Exam Name",flex:1,editable:!0,headerClassName:"theme--header"},{field:"examType",headerName:"Exam Type",flex:1,editable:!0,headerClassName:"theme--header"},{field:"duration",headerName:"Duration (min)",flex:1,editable:!0,headerClassName:"theme--header"},{field:"totalMarks",headerName:"Total Marks",flex:1,editable:!0,headerClassName:"theme--header"},{field:"startDate",headerName:"Start Date",flex:1,editable:!0,headerClassName:"theme--header"},{field:"endDate",headerName:"End Date",flex:1,editable:!0,headerClassName:"theme--header"},{field:"schedule",headerName:"Schedule",flex:1,editable:!0,headerClassName:"theme--header"},{field:"description",headerName:"Description",flex:1,editable:!0,headerClassName:"theme--header"}],[]),[e,m]=d.useState({}),[r,h]=d.useState(!1),[N,f]=d.useState(void 0),[u,b]=d.useState(null),{data:o,loading:_}=S(t=>t.exam),x=S(t=>t.auth.user),g=d.useMemo(()=>!x||!(o!=null&&o.exams)?[]:o.exams.filter(t=>U(x,"exams","view",t)),[x,o]),w=d.useCallback(t=>{a(n.fetchExams(t))},[a]),{params:p,setParams:D}=X({page:1,limit:10,sortBy:void 0,sortOrder:void 0,searchTerm:void 0,filters:{}},w),v=t=>{D(t)},M=()=>{b(null),f("Add Exam"),y()},P=t=>{const A=o==null?void 0:o.exams.find(F=>F._id===t);b(A),f("Edit Exam"),y()},j=async t=>{a(n.deleteExam(t))},R=async t=>{a(u?n.updateExam({id:u._id,...t}):n.createExam(t)),E()},B=()=>{a(n.fetchExams(p))},y=()=>h(!0),E=()=>h(!1),T=(o==null?void 0:o.totalExams)||0;return l.jsxs(W,{sx:{width:"100%",height:"100%",minWidth:0,overflow:"hidden"},children:[l.jsx(Y,{columns:s,onAdd:M,onDelete:j,onEdit:P,rows:g??[],rowModesModel:e,setRowModesModel:m,loading:_,reloadData:B,totalRows:T,paginationModel:{page:p.page-1,pageSize:p.limit},onParamsChange:t=>v(t)}),r&&l.jsx(d.Suspense,{fallback:l.jsx("div",{children:"Loading modal..."}),children:l.jsx(re,{open:r,onClose:E,title:N,children:l.jsx(d.Suspense,{fallback:l.jsx("div",{children:"Loading form..."}),children:l.jsx(se,{initialValues:u,onSubmit:R,onClose:E})})})})]})}export{je as default};
//# sourceMappingURL=Exam.page-DeZ-GuhD.js.map
