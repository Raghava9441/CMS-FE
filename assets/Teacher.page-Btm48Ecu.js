import{q as U,V as Z,W as I,X as $,Y as q,x as C,Z as J,$ as K,a0 as L,a1 as X,a2 as V,a3 as ee,a4 as re,a5 as ae,K as w,r as j,o as _,j as e,Q as F,T as M,B as E,p as P,J as se}from"./index-cI54VIJ9.js";import{u as te,C as m,a as ne,R as ie,G as oe}from"./usePaginationParams-BHf9Vfpo.js";import{G as c}from"./Grid-Bk4VUh1S.js";import{F as W,I as B,S as O,a as Y,T as x}from"./TextField-Buuigu5Y.js";import"./useId-f-u0aL7Q.js";import"./reselect-Bw7g3QAn.js";import"./Popper-DKX0mmd1.js";import"./Tooltip-kWfpJ4zF.js";import"./Checkbox-hz0x4XZb.js";import"./FormControlLabel-CN2DG0ht.js";import"./KeyboardArrowRight-CiPjfqhy.js";import"./CircularProgress-BFDqn9r3.js";import"./Skeleton-DRqHfmOo.js";try{let r=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},a=new r.Error().stack;a&&(r._sentryDebugIds=r._sentryDebugIds||{},r._sentryDebugIds[a]="5d38d5a2-3de6-4e85-9546-084d7c5c475e",r._sentryDebugIdIdentifier="sentry-dbid-5d38d5a2-3de6-4e85-9546-084d7c5c475e")}catch{}const le=r=>async a=>{var n,f;try{const h=U(r);a(Z());const u=await I.getTeachers(h);a($(u.data.data))}catch(h){a(q()),C.error(((f=(n=h.response)==null?void 0:n.data)==null?void 0:f.data)||"Failed to fetch organizations",{autoClose:3e3})}},de=r=>async a=>{try{a(re());const n=await I.getTeacherById(r);a(ae(n.data.data))}catch(n){a(q()),C.error(n.response.data.data||"Failed to fetch organization",{autoClose:3e3})}},ce=r=>async a=>{try{a(V());const n=await I.createTeacher(r);return a(ee(n.data.data)),n.data}catch(n){a(q()),C.error(n.response.data.data||"Failed to fetch organization",{autoClose:3e3})}},ue=r=>async a=>{try{if(a(L()),r._id){const n=await I.updateTeacher(r,r._id);return a(X(n.data.data)),n.data}else throw new Error("Teacher ID is required for update")}catch(n){a(q()),n instanceof Error&&C.error(n.message||"Failed to fetch organization",{autoClose:3e3})}},me=r=>async a=>{try{a(J());const n=await I.deleteTeacher(r);a(K(r)),C.info(n.message||"Organization deleted successfully",{autoClose:3e3})}catch(n){a(q()),console.log(n),C.error(n.response.data.data||"Failed to fetch organization",{autoClose:3e3})}},A={fetchTeachers:le,fetchTeacherById:de,createTeachers:ce,updateTeachers:ue,deleteTeachers:me},he=({initialValues:r,onSubmit:a,onClose:n})=>{var b;const{data:f}=w(s=>s.user),{data:h}=w(s=>s.organization),u=(b=f==null?void 0:f.users)==null?void 0:b.filter(s=>s.role==="TEACHER"),p=h==null?void 0:h.organizations,T={_id:"",userId:"",name:"",phone:"",email:"",organizationId:"",organizations:[],departments:[],subjects:[],qualifications:"",experience:0,officeHours:"",coursesTaught:[],performanceReviews:[],specialResponsibilities:"",createdAt:null,updatedAt:null},{control:l,handleSubmit:D,formState:{errors:i},reset:S}=te({defaultValues:T});j.useEffect(()=>{r&&S({...r,createdAt:r.createdAt?_(r.createdAt):null,updatedAt:r.updatedAt?_(r.updatedAt):null})},[r,S]);const N=s=>{const t={...s,createdAt:s.createdAt?s.createdAt.format("YYYY-MM-DD"):null,updatedAt:s.updatedAt?s.updatedAt.format("YYYY-MM-DD"):null};a(t)};return e.jsx("form",{onSubmit:D(N),children:e.jsxs(c,{container:!0,spacing:2,children:[e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(m,{name:"userId",control:l,rules:{required:"User ID is required"},render:({field:s})=>{var t;return e.jsxs(W,{fullWidth:!0,margin:"normal",error:!!i.userId,children:[e.jsx(B,{children:"User ID"}),e.jsx(O,{...s,label:"User ID",renderValue:d=>{var g;return e.jsx(M,{variant:"body2",children:(g=u==null?void 0:u.find(y=>y._id===d))==null?void 0:g.username})},children:u==null?void 0:u.map(d=>e.jsx(F,{value:d._id,children:d.username},d._id))}),e.jsx(Y,{children:(t=i.userId)==null?void 0:t.message})]})}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(m,{name:"name",control:l,rules:{required:"Name is required"},render:({field:s})=>{var t;return e.jsx(x,{...s,label:"Name",fullWidth:!0,margin:"normal",error:!!i.name,helperText:(t=i.name)==null?void 0:t.message})}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(m,{name:"phone",control:l,rules:{required:"Phone is required",pattern:{value:/^[0-9]{10}$/,message:"Invalid phone number"}},render:({field:s})=>{var t;return e.jsx(x,{...s,label:"Phone Number",fullWidth:!0,margin:"normal",error:!!i.phone,helperText:(t=i.phone)==null?void 0:t.message})}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(m,{name:"email",control:l,rules:{required:"Email is required",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Invalid email address"}},render:({field:s})=>{var t;return e.jsx(x,{...s,label:"Email",fullWidth:!0,margin:"normal",error:!!i.email,helperText:(t=i.email)==null?void 0:t.message})}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(m,{name:"phone",control:l,rules:{pattern:{value:/^[0-9]{10}$/,message:"Invalid phone number"}},render:({field:s})=>{var t;return e.jsx(x,{...s,label:"Phone Number",fullWidth:!0,margin:"normal",error:!!i.phone,helperText:(t=i.phone)==null?void 0:t.message})}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(m,{name:"organizationId",control:l,rules:{required:"Organization is required"},render:({field:s})=>{var t;return e.jsxs(W,{fullWidth:!0,margin:"normal",error:!!i.organizationId,children:[e.jsx(B,{children:"Organization"}),e.jsx(O,{...s,label:"Organization",renderValue:d=>e.jsx(E,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:d.map(g=>{var y;return e.jsx(M,{component:"span",variant:"body2",children:(y=p==null?void 0:p.find(v=>v.id===g))==null?void 0:y.name},g)})}),children:p==null?void 0:p.map(d=>e.jsx(F,{value:d.id,children:d.name},d.id))}),e.jsx(Y,{children:(t=i.organizationId)==null?void 0:t.message})]})}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(m,{name:"qualifications",control:l,rules:{required:"Qualifications is required"},render:({field:s})=>{var t;return e.jsx(x,{...s,label:"Qualifications",fullWidth:!0,margin:"normal",error:!!i.qualifications,helperText:(t=i.qualifications)==null?void 0:t.message})}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(m,{name:"experience",control:l,rules:{required:"Experience is required"},render:({field:s})=>{var t;return e.jsx(x,{...s,label:"Experience",fullWidth:!0,margin:"normal",error:!!i.experience,helperText:(t=i.experience)==null?void 0:t.message})}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(m,{name:"officeHours",control:l,rules:{required:"Office Hours is required"},render:({field:s})=>{var t;return e.jsx(x,{...s,label:"Office Hours",fullWidth:!0,margin:"normal",error:!!i.officeHours,helperText:(t=i.officeHours)==null?void 0:t.message})}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(m,{name:"specialResponsibilities",control:l,rules:{required:"Special Responsibilities is required"},render:({field:s})=>{var t;return e.jsx(x,{...s,label:"Special Responsibilities",fullWidth:!0,margin:"normal",error:!!i.specialResponsibilities,helperText:(t=i.specialResponsibilities)==null?void 0:t.message})}})}),e.jsx(c,{item:!0,xs:12,children:e.jsxs(E,{sx:{display:"flex",justifyContent:"flex-end",gap:2,mt:2},children:[e.jsx(P,{variant:"outlined",color:"primary",onClick:()=>{S(T),n()},children:"Cancel"}),e.jsx(P,{type:"submit",variant:"contained",color:"primary",children:"Save"})]})})]})})};function we(){const r=se(),a=w(o=>o.teacher.data),n=j.useMemo(()=>[{field:"name",headerName:"Teacher Name",flex:1,editable:!0,headerClassName:"theme--header"},{field:"phone",headerName:"Contact Phone",flex:1,editable:!0,headerClassName:"theme--header"},{field:"subjects",headerName:"Subjects",flex:1,editable:!0,headerClassName:"theme--header"},{field:"qualifications",headerName:"Qualifications",flex:1,editable:!0,headerClassName:"theme--header"},{field:"coursesTaught",headerName:"Courses Taught",flex:1,editable:!0,headerClassName:"theme--header"},{field:"createdAt",headerName:"Created At",flex:1,editable:!1,headerClassName:"theme--header"},{field:"updatedAt",headerName:"Updated At",flex:1,editable:!1,headerClassName:"theme--header"}],[]),[f,h]=j.useState({}),[u,p]=j.useState(""),[T,l]=j.useState(null),[D,i]=j.useState(!1),{loading:S}=w(o=>o.teacher),N=j.useCallback(o=>{r(A.fetchTeachers(o))},[r]),{params:b,setParams:s}=ne({page:1,limit:10,sortBy:void 0,sortOrder:void 0,searchTerm:void 0,filters:{}},N),t=o=>{s(o)},d=()=>{l(null),p("Add Teacher"),z()},g=o=>{const Q=a==null?void 0:a.teachers.find(k=>k._id===o);l(Q||null),p("Edit Teacher"),z()},y=async o=>{r(A.deleteTeachers(o))},v=async o=>{r(T?A.updateTeachers({...o,_id:T._id}):A.createTeachers(o)),R()},H=()=>{r(A.fetchTeachers(b))},z=()=>i(!0),R=()=>i(!1),G=(a==null?void 0:a.totalTeachers)||0;return e.jsxs(E,{sx:{width:"100%",height:"100%"},children:[e.jsx(ie,{columns:n,onAdd:d,onDelete:y,onEdit:g,rows:(a==null?void 0:a.teachers)??[],rowModesModel:f,setRowModesModel:h,loading:S,reloadData:H,totalRows:G,paginationModel:{page:b.page-1,pageSize:b.limit},onParamsChange:o=>t(o)}),e.jsx(oe,{open:D,onClose:R,title:u,children:e.jsx(he,{initialValues:T,onSubmit:v,onClose:R})})]})}export{we as default};
//# sourceMappingURL=Teacher.page-Btm48Ecu.js.map
